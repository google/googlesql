[prepare_database]
CREATE TABLE TestTable AS
SELECT cast(0 as int64) as row_id, cast(null as double) as value UNION ALL
  SELECT 1, cast('inf' as double)                                UNION ALL
  SELECT 2, cast('-inf' as double)                               UNION ALL
  SELECT 3, cast('nan' as double)                                UNION ALL
  SELECT 4, 1.0786158809173895e+308                              UNION ALL
  SELECT 5, -1.0786158809173895e+308                             UNION ALL
  SELECT 6, 4.94065645841247e-324                                UNION ALL
  SELECT 7, 0                                                    UNION ALL
  SELECT 8, -100                                                 UNION ALL
  SELECT 9, -400
--
ARRAY<STRUCT<row_id INT64, value DOUBLE>>[
  {0, NULL},
  {1, inf},
  {2, -inf},
  {3, nan},
  {
    4,
    1.0786158809173895e+308
  },
  {
    5,
    -1.0786158809173895e+308
  },
  {
    6,
    4.94065645841247e-324
  },
  {7, 0},
  {8, -100},
  {9, -400}
]
==

[prepare_database]
CREATE TABLE TestTable2 AS
SELECT cast(0 as int64) as row_id,
       cast(1 as int64) as key,
       cast(null as double) as value    UNION ALL
  SELECT 1, 2,  null                    UNION ALL
  SELECT 2, 2,  13.5                    UNION ALL
  SELECT 3, 2,  null                    UNION ALL
  SELECT 4, 2,  -200                    UNION ALL
  SELECT 5, 2,  null                    UNION ALL
  SELECT 6, 3,  null                    UNION ALL
  SELECT 7, 3,  1.0                     UNION ALL
  SELECT 8, 3,  cast('nan' as double)   UNION ALL
  SELECT 9, 3,  cast('inf' as double)   UNION ALL
  SELECT 10, 4,  cast('-inf' as double) UNION ALL
  SELECT 11, 4,  cast('inf' as double)  UNION ALL
  SELECT 12, 5,  100                    UNION ALL
  SELECT 13, 5,  -200                   UNION ALL
  SELECT 14, 5,  cast('-inf' as double) UNION ALL
  SELECT 15, 5,  70
--
ARRAY<STRUCT<row_id INT64, key INT64, value DOUBLE>>[
  {0, 1, NULL},
  {1, 2, NULL},
  {2, 2, 13.5},
  {3, 2, NULL},
  {4, 2, -200},
  {5, 2, NULL},
  {6, 3, NULL},
  {7, 3, 1},
  {8, 3, nan},
  {9, 3, inf},
  {10, 4, -inf},
  {11, 4, inf},
  {12, 5, 100},
  {13, 5, -200},
  {14, 5, -inf},
  {15, 5, 70}
]

==
[prepare_database]
[required_features=NUMERIC_TYPE]
CREATE TABLE TestNumericTable AS
SELECT 0 as row_id, null as key, cast(null as numeric) as value UNION ALL
  SELECT 1, null, 99999999999999999999999999999.999999999       UNION ALL
  SELECT 2, 0, -99999999999999999999999999999.999999999         UNION ALL
  SELECT 3, 0, -1e-9                                            UNION ALL
  SELECT 4, null, null                                          UNION ALL
  SELECT 5, 0, 0                                                UNION ALL
  SELECT 6, 0, 1                                                UNION ALL
  SELECT 7, 0, -1e-9                                            UNION ALL
  SELECT 8, 0, -10000000000000000000000000000.000000001         UNION ALL
  SELECT 9, null, 99999999999999999999999999999.999999999       UNION ALL
  SELECT 10, null, -99999999999999999999999999999.999999999
--
ARRAY<STRUCT<row_id INT64, key INT64, value NUMERIC>>[
  {0, NULL, NULL},
  {
    1,
    NULL,
    99999999999999999999999999999.999999999
  },
  {
    2,
    0,
    -99999999999999999999999999999.999999999
  },
  {3, 0, -0.000000001},
  {4, NULL, NULL},
  {5, 0, 0},
  {6, 0, 1},
  {7, 0, -0.000000001},
  {
    8,
    0,
    -10000000000000000000000000000.000000001
  },
  {
    9,
    NULL,
    99999999999999999999999999999.999999999
  },
  {
    10,
    NULL,
    -99999999999999999999999999999.999999999
  }
]
==
[prepare_database]
[required_features=BIGNUMERIC_TYPE]
CREATE TABLE TestBigNumericTable AS
SELECT 0 as row_id, null as key, cast(null as bignumeric) as value UNION ALL
  SELECT 1, null, 5e38       UNION ALL
  SELECT 2, 0, -5e38         UNION ALL
  SELECT 3, 0, -1e-38        UNION ALL
  SELECT 4, null, null       UNION ALL
  SELECT 5, 0, 0              UNION ALL
  SELECT 6, 0, 1                   UNION ALL
  SELECT 7, 0, -1e-38                                            UNION ALL
  SELECT 8, 0, -100000000000000000000000000000000000000.00000000000000000000000000000000000001                                            UNION ALL
  SELECT 9, null, 5e38       UNION ALL
  SELECT 10, null, -5e38
--
ARRAY<STRUCT<row_id INT64, key INT64, value BIGNUMERIC>>[
  {0, NULL, NULL},
  {
    1,
    NULL,
    500000000000000000000000000000000000000
  },
  {
    2,
    0,
    -500000000000000000000000000000000000000
  },
  {
    3,
    0,
    -0.00000000000000000000000000000000000001
  },
  {4, NULL, NULL},
  {5, 0, 0},
  {6, 0, 1},
  {
    7,
    0,
    -0.00000000000000000000000000000000000001
  },
  {
    8,
    0,
    -100000000000000000000000000000000000000.00000000000000000000000000000000000001
  },
  {
    9,
    NULL,
    500000000000000000000000000000000000000
  },
  {
    10,
    NULL,
    -500000000000000000000000000000000000000
  }
]
==

[name=aggregate_percentile_cont]
SELECT PERCENTILE_CONT(value, -0.0),
       PERCENTILE_CONT(value, 0),
       PERCENTILE_CONT(value, 0.125),
       PERCENTILE_CONT(value, 0.25),
       PERCENTILE_CONT(value, 0.375),
       PERCENTILE_CONT(value, 0.5),
       PERCENTILE_CONT(value, 0.625),
       PERCENTILE_CONT(value, 0.75),
       PERCENTILE_CONT(value, 0.875),
       PERCENTILE_CONT(value, 1)
FROM TestTable
--
ARRAY<STRUCT<DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE>>
[{
   nan,
   nan,
   -inf,
   -1.0786158809173895e+308,
   -400,
   -100,
   0,
   4.94065645841247e-324,
   1.0786158809173895e+308,
   inf
 }]
==

[name=aggregate_percentile_cont_interpolation]
SELECT PERCENTILE_CONT(value, 4.94065645841247e-324),
       PERCENTILE_CONT(value, 0.1249999999999999),
       PERCENTILE_CONT(value, 0.2499999999999999),
       PERCENTILE_CONT(value, 0.3),
       PERCENTILE_CONT(value, 0.4375),
       PERCENTILE_CONT(value, 0.5625),
       PERCENTILE_CONT(value, 0.65),
       PERCENTILE_CONT(value, 0.7),
       PERCENTILE_CONT(value, 0.8125),
       PERCENTILE_CONT(value, 0.8750000000000001)
FROM TestTable
--
ARRAY<STRUCT<DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE>>
[{
   nan,
   nan,
   -inf,
   -6.471695285504338e+307,
   -250,
   -50,
   0,
   4.94065645841247e-324,
   5.3930794045869475e+307,
   inf
 }]
==

[required_features=NUMERIC_TYPE]
[name=aggregate_percentile_cont_numeric]
SELECT PERCENTILE_CONT(value, NUMERIC "0"),
       PERCENTILE_CONT(value, NUMERIC "1e-9"),
       PERCENTILE_CONT(value, NUMERIC "0.125"),
       PERCENTILE_CONT(value, NUMERIC "0.2"),
       PERCENTILE_CONT(value, NUMERIC "0.25"),
       PERCENTILE_CONT(value, NUMERIC "0.3"),
       PERCENTILE_CONT(value, NUMERIC "0.5"),
       PERCENTILE_CONT(value, NUMERIC "0.625"),
       PERCENTILE_CONT(value, NUMERIC "0.699999999"),
       PERCENTILE_CONT(value, NUMERIC "0.7"),
       PERCENTILE_CONT(value, NUMERIC "0.700000001"),
       PERCENTILE_CONT(value, NUMERIC "0.75"),
       PERCENTILE_CONT(value, NUMERIC "0.8"),
       PERCENTILE_CONT(value, NUMERIC "0.875"),
       PERCENTILE_CONT(value, NUMERIC "0.9"),
       PERCENTILE_CONT(value, NUMERIC "1")
FROM TestNumericTable
--
ARRAY<STRUCT<NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC>>
[{
   -99999999999999999999999999999.999999999,
   -99999999999999999999999999999.999999999,
   -99999999999999999999999999999.999999999,
   -46000000000000000000000000000,
   -10000000000000000000000000000.000000001,
   -6000000000000000000000000000.000000001,
   -0.000000001,
   0,
   0.599999992,
   0.6,
   0.600000008,
   1,
   40000000000000000000000000000.6,
   99999999999999999999999999999.999999999,
   99999999999999999999999999999.999999999,
   99999999999999999999999999999.999999999
 }]
==

[required_features=BIGNUMERIC_TYPE]
[name=aggregate_percentile_cont_bignumeric]
SELECT PERCENTILE_CONT(value, BIGNUMERIC "0"),
       PERCENTILE_CONT(value, BIGNUMERIC "1e-38"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.125"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.2"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.25"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.3"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.5"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.625"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.69999999999999999999999999999999999999"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.7"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.70000000000000000000000000000000000001"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.75"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.8"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.875"),
       PERCENTILE_CONT(value, BIGNUMERIC "0.9"),
       PERCENTILE_CONT(value, BIGNUMERIC "1")
FROM TestBigNumericTable
--
ARRAY<STRUCT<BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC>>
[
  {
    -500000000000000000000000000000000000000,
    -500000000000000000000000000000000000000,
    -500000000000000000000000000000000000000,
    -260000000000000000000000000000000000000.00000000000000000000000000000000000001,
    -100000000000000000000000000000000000000.00000000000000000000000000000000000001,
    -60000000000000000000000000000000000000.00000000000000000000000000000000000001,
    -0.00000000000000000000000000000000000001,
    0,
    0.59999999999999999999999999999999999992,
    0.6,
    0.60000000000000000000000000000000000008,
    1,
    200000000000000000000000000000000000000.6,
    500000000000000000000000000000000000000,
    500000000000000000000000000000000000000,
    500000000000000000000000000000000000000
  }
]
==

[name=aggregate_percentile_cont_group_by]
SELECT x_id, y_id, PERCENTILE_CONT(z, 0.5)
FROM (
  SELECT t1.row_id x_id, t1.value x, t2.row_id y_id, t2.value y
  FROM TestTable t1, TestTable t2
  WHERE t1.row_id <= 5 AND t2.row_id <= 5
) t3, UNNEST([t3.x, t3.y]) z
GROUP BY x_id, y_id
--
ARRAY<STRUCT<x_id INT64, y_id INT64, DOUBLE>>[unknown order:
  {0, 0, NULL},
  {0, 1, inf},
  {0, 2, -inf},
  {0, 3, nan},
  {
    0,
    4,
    1.0786158809173895e+308
  },
  {
    0,
    5,
    -1.0786158809173895e+308
  },
  {1, 0, inf},
  {1, 1, inf},
  {1, 2, nan},
  {1, 3, nan},
  {1, 4, inf},
  {1, 5, inf},
  {2, 0, -inf},
  {2, 1, nan},
  {2, 2, -inf},
  {2, 3, nan},
  {2, 4, -inf},
  {2, 5, -inf},
  {3, 0, nan},
  {3, 1, nan},
  {3, 2, nan},
  {3, 3, nan},
  {3, 4, nan},
  {3, 5, nan},
  {
    4,
    0,
    1.0786158809173895e+308
  },
  {4, 1, inf},
  {4, 2, -inf},
  {4, 3, nan},
  {
    4,
    4,
    1.0786158809173895e+308
  },
  {4, 5, 0},
  {
    5,
    0,
    -1.0786158809173895e+308
  },
  {5, 1, inf},
  {5, 2, -inf},
  {5, 3, nan},
  {5, 4, 0},
  {
    5,
    5,
    -1.0786158809173895e+308
  }
]
==

[name=aggregate_percentile_cont_group_by_non_null]
SELECT key,
       PERCENTILE_CONT(value, 0),
       PERCENTILE_CONT(value, 0.375),
       PERCENTILE_CONT(value, 0.5),
       PERCENTILE_CONT(value, 0.625),
       PERCENTILE_CONT(value, 1)
FROM (SELECT 1 value, 1 key UNION ALL
      SELECT 1, 1            UNION ALL
      SELECT 5, 2            UNION ALL
      SELECT 6, 4            UNION ALL
      SELECT 5, 5            UNION ALL
      SELECT 8, 4            UNION ALL
      SELECT 10, 3            UNION ALL
      SELECT 1, 3            UNION ALL
      SELECT 4, 2            UNION ALL
      SELECT 2, 2)
GROUP BY key
--
ARRAY<STRUCT<key INT64, DOUBLE, DOUBLE, DOUBLE, DOUBLE, DOUBLE>>[unknown order:
  {1, 1, 1, 1, 1, 1},
  {2, 2, 3.5, 4, 4.25, 5},
  {3, 1, 4.375, 5.5, 6.625, 10},
  {4, 6, 6.75, 7, 7.25, 8},
  {5, 5, 5, 5, 5, 5}
]
==

[required_features=NULL_HANDLING_MODIFIER_IN_AGGREGATE]
[name=aggregate_percentile_cont_ignore_nulls]
SELECT PERCENTILE_CONT(value, 0 IGNORE NULLS),
       PERCENTILE_CONT(value, 0.125 IGNORE NULLS),
       PERCENTILE_CONT(value, 0.5 IGNORE NULLS),
       PERCENTILE_CONT(value, 0.75 IGNORE NULLS),
       PERCENTILE_CONT(value, 1 IGNORE NULLS)
FROM TestTable2
--
ARRAY<STRUCT<DOUBLE, DOUBLE, DOUBLE, DOUBLE, DOUBLE>>[{nan, -inf, 1, 85, inf}]
==

[required_features=NULL_HANDLING_MODIFIER_IN_AGGREGATE]
[name=aggregate_percentile_cont_groupby_ignore_nulls]
SELECT key,
       PERCENTILE_CONT(value, 0 IGNORE NULLS),
       PERCENTILE_CONT(value, 0.375 IGNORE NULLS),
       PERCENTILE_CONT(value, 0.5 IGNORE NULLS),
       PERCENTILE_CONT(value, 0.625 IGNORE NULLS),
       PERCENTILE_CONT(value, 1 IGNORE NULLS)
FROM TestTable2
GROUP BY key
--
ARRAY<STRUCT<key INT64, DOUBLE, DOUBLE, DOUBLE, DOUBLE, DOUBLE>>[unknown order:
  {1, NULL, NULL, NULL, NULL, NULL},
  {2, -200, -119.9375, -93.25, -66.5625, 13.5},
  {3, nan, nan, 1, inf, inf},
  {4, -inf, nan, nan, nan, inf},
  {5, -inf, -166.25, -65, 36.25, 100}
]
==

[required_features=NULL_HANDLING_MODIFIER_IN_AGGREGATE]
[name=aggregate_percentile_cont_respect_nulls]
SELECT PERCENTILE_CONT(value, 0 RESPECT NULLS),
       PERCENTILE_CONT(value, 0.125 RESPECT NULLS),
       PERCENTILE_CONT(value, 0.5 RESPECT NULLS),
       PERCENTILE_CONT(value, 0.75 RESPECT NULLS),
       PERCENTILE_CONT(value, 1 RESPECT NULLS)
FROM TestTable2
--
ARRAY<STRUCT<DOUBLE, DOUBLE, DOUBLE, DOUBLE, DOUBLE>>[
  {NULL, NULL, -inf, 27.625, inf}
]
==

[required_features=NULL_HANDLING_MODIFIER_IN_AGGREGATE]
[name=aggregate_percentile_cont_group_by_respect_nulls]
SELECT key,
       PERCENTILE_CONT(value, 0 RESPECT NULLS),
       PERCENTILE_CONT(value, 0.375 RESPECT NULLS),
       PERCENTILE_CONT(value, 0.5 RESPECT NULLS),
       PERCENTILE_CONT(value, 0.625 RESPECT NULLS),
       PERCENTILE_CONT(value, 1 RESPECT NULLS)
FROM TestTable2
GROUP BY key
--
ARRAY<STRUCT<key INT64, DOUBLE, DOUBLE, DOUBLE, DOUBLE, DOUBLE>>[unknown order:
  {1, NULL, NULL, NULL, NULL, NULL},
  {2, NULL, NULL, NULL, -200, 13.5},
  {3, NULL, nan, nan, nan, inf},
  {4, -inf, nan, nan, nan, inf},
  {5, -inf, -166.25, -65, 36.25, 100}
]
==

[required_features=NULL_HANDLING_MODIFIER_IN_AGGREGATE,NUMERIC_TYPE]
[name=aggregate_percentile_cont_numeric_ignore_nulls]
SELECT key,
PERCENTILE_CONT(value, NUMERIC "0" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "0.1" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "0.2" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "0.3" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "0.4" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "0.5" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "0.6" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "0.7" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "0.8" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "0.9" IGNORE NULLS),
PERCENTILE_CONT(value, NUMERIC "1" IGNORE NULLS)
FROM TestNumericTable
group by key
--
ARRAY<STRUCT<key INT64,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC>>
[unknown order:{
                 NULL,
                 -99999999999999999999999999999.999999999,
                 -59999999999999999999999999999.999999999,
                 -20000000000000000000000000000,
                 20000000000000000000000000000,
                 59999999999999999999999999999.999999999,
                 99999999999999999999999999999.999999999,
                 99999999999999999999999999999.999999999,
                 99999999999999999999999999999.999999999,
                 99999999999999999999999999999.999999999,
                 99999999999999999999999999999.999999999,
                 99999999999999999999999999999.999999999
               },
               {
                 0,
                 -99999999999999999999999999999.999999999,
                 -55000000000000000000000000000,
                 -10000000000000000000000000000.000000001,
                 -5000000000000000000000000000.000000001,
                 -0.000000001,
                 -0.000000001,
                 -0.000000001,
                 -0.000000001,
                 0,
                 0.5,
                 1
               }]
==

[required_features=NULL_HANDLING_MODIFIER_IN_AGGREGATE,BIGNUMERIC_TYPE]
[name=aggregate_percentile_cont_bignumeric_ignore_nulls]
SELECT key,
PERCENTILE_CONT(value, BIGNUMERIC "0" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.1" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.2" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.3" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.4" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.5" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.6" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.7" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.8" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.9" IGNORE NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "1" IGNORE NULLS)
FROM TestBigNumericTable
group by key
--
ARRAY<STRUCT<key INT64,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC>>
[unknown order:
  {
    NULL,
    -500000000000000000000000000000000000000,
    -300000000000000000000000000000000000000,
    -100000000000000000000000000000000000000,
    100000000000000000000000000000000000000,
    300000000000000000000000000000000000000,
    500000000000000000000000000000000000000,
    500000000000000000000000000000000000000,
    500000000000000000000000000000000000000,
    500000000000000000000000000000000000000,
    500000000000000000000000000000000000000,
    500000000000000000000000000000000000000
  },
  {
    0,
    -500000000000000000000000000000000000000,
    -300000000000000000000000000000000000000.00000000000000000000000000000000000001,
    -100000000000000000000000000000000000000.00000000000000000000000000000000000001,
    -50000000000000000000000000000000000000.00000000000000000000000000000000000001,
    -0.00000000000000000000000000000000000001,
    -0.00000000000000000000000000000000000001,
    -0.00000000000000000000000000000000000001,
    -0.00000000000000000000000000000000000001,
    0,
    0.5,
    1
  }
]
==

[required_features=NULL_HANDLING_MODIFIER_IN_AGGREGATE,NUMERIC_TYPE]
[name=aggregate_percentile_cont_numeric_respect_nulls]
SELECT key,
PERCENTILE_CONT(value, NUMERIC "0" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "0.1" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "0.2" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "0.3" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "0.4" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "0.5" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "0.6" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "0.7" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "0.8" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "0.9" RESPECT NULLS),
PERCENTILE_CONT(value, NUMERIC "1" RESPECT NULLS)
FROM TestNumericTable
group by key
--
ARRAY<STRUCT<key INT64,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC,
             NUMERIC>>
[unknown order:{
                 NULL,
                 NULL,
                 NULL,
                 NULL,
                 -99999999999999999999999999999.999999999,
                 -99999999999999999999999999999.999999999,
                 -99999999999999999999999999999.999999999,
                 -20000000000000000000000000000,
                 59999999999999999999999999999.999999999,
                 99999999999999999999999999999.999999999,
                 99999999999999999999999999999.999999999,
                 99999999999999999999999999999.999999999
               },
               {
                 0,
                 -99999999999999999999999999999.999999999,
                 -55000000000000000000000000000,
                 -10000000000000000000000000000.000000001,
                 -5000000000000000000000000000.000000001,
                 -0.000000001,
                 -0.000000001,
                 -0.000000001,
                 -0.000000001,
                 0,
                 0.5,
                 1
               }]
==

[required_features=NULL_HANDLING_MODIFIER_IN_AGGREGATE,BIGNUMERIC_TYPE]
[name=aggregate_percentile_cont_bignumeric_respect_nulls]
SELECT key,
PERCENTILE_CONT(value, BIGNUMERIC "0" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.1" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.2" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.3" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.4" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.5" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.6" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.7" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.8" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "0.9" RESPECT NULLS),
PERCENTILE_CONT(value, BIGNUMERIC "1" RESPECT NULLS)
FROM TestBigNumericTable
group by key
--
ARRAY<STRUCT<key INT64,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC,
             BIGNUMERIC>>
[unknown order:
  {
    NULL,
    NULL,
    NULL,
    NULL,
    -500000000000000000000000000000000000000,
    -500000000000000000000000000000000000000,
    -500000000000000000000000000000000000000,
    -100000000000000000000000000000000000000,
    300000000000000000000000000000000000000,
    500000000000000000000000000000000000000,
    500000000000000000000000000000000000000,
    500000000000000000000000000000000000000
  },
  {
    0,
    -500000000000000000000000000000000000000,
    -300000000000000000000000000000000000000.00000000000000000000000000000000000001,
    -100000000000000000000000000000000000000.00000000000000000000000000000000000001,
    -50000000000000000000000000000000000000.00000000000000000000000000000000000001,
    -0.00000000000000000000000000000000000001,
    -0.00000000000000000000000000000000000001,
    -0.00000000000000000000000000000000000001,
    -0.00000000000000000000000000000000000001,
    0,
    0.5,
    1
  }
]
