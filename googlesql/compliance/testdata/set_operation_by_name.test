# This file contains compliance test cases for BY NAME in set operations.
# This tests that the syntax works but doesn't cover all the details
# because we assume those are covered in tests for CORRESPONDING syntaxes,
# which produce the same Resolved ASTs.

# Literal coercion STRICT mode
[name=by_name]
[default required_features=CORRESPONDING_FULL,BY_NAME]
SELECT 1 AS a, 2 AS b
UNION ALL BY NAME
SELECT 3 AS b, 4 AS a
--
ARRAY<STRUCT<a INT64, b INT64>>[unknown order:{1, 2}, {4, 3}]
==

[name=inner]
[default required_features=CORRESPONDING_FULL,BY_NAME]
SELECT 1 AS b, 2 AS a, 5 AS z
INNER UNION ALL BY NAME
SELECT 6 AS y, 3 AS b, 4 AS a
--
ARRAY<STRUCT<b INT64, a INT64>>[unknown order:{1, 2}, {3, 4}]
==

[name=full]
[default required_features=CORRESPONDING_FULL,BY_NAME]
SELECT 1 AS b, 2 AS a, 5 AS z
FULL UNION ALL BY NAME
SELECT 6 AS y, 3 AS b, 4 AS a
--
ARRAY<STRUCT<b INT64, a INT64, z INT64, y INT64>>[unknown order:
  {1, 2, 5, NULL},
  {3, 4, NULL, 6}
]
==

[name=left]
[default required_features=CORRESPONDING_FULL,BY_NAME]
SELECT 1 AS b, 2 AS a, 5 AS z
FULL UNION ALL BY NAME
SELECT 6 AS y, 3 AS b, 4 AS a
--
ARRAY<STRUCT<b INT64, a INT64, z INT64, y INT64>>[unknown order:
  {1, 2, 5, NULL},
  {3, 4, NULL, 6}
]
==

[name=by_name_on]
[default required_features=CORRESPONDING_FULL,BY_NAME]
SELECT 1 AS a, 2 AS b
UNION ALL BY NAME ON (B, a)
SELECT 3 AS b, 4 AS a
--
ARRAY<STRUCT<B INT64, a INT64>>[unknown order:{2, 1}, {3, 4}]
==

[name=inner_on]
[default required_features=CORRESPONDING_FULL,BY_NAME]
SELECT 1 AS b, 2 AS a, 5 AS z
INNER UNION ALL BY NAME ON (B, a)
SELECT 6 AS y, 3 AS b, 4 AS a
--
ARRAY<STRUCT<B INT64, a INT64>>[unknown order:{1, 2}, {3, 4}]
==

[name=full_on]
[default required_features=CORRESPONDING_FULL,BY_NAME]
SELECT 1 AS b, 2 AS a, 5 AS z
FULL UNION ALL BY NAME ON (B, z, y)
SELECT 6 AS y, 3 AS b, 4 AS a
--
ARRAY<STRUCT<B INT64, z INT64, y INT64>>[unknown order:
  {1, 5, NULL},
  {3, NULL, 6}
]
==

[name=left_on]
[default required_features=CORRESPONDING_FULL,BY_NAME]
SELECT 1 AS b, 2 AS a, 5 AS z
LEFT UNION ALL BY NAME ON (B, z)
SELECT 6 AS y, 3 AS b, 4 AS a
--
ARRAY<STRUCT<B INT64, z INT64>>[unknown order:{1, 5}, {3, NULL}]
