[prepare_database]
CREATE TEMP TABLE T1 AS SELECT 1 as a;
--
ARRAY<STRUCT<a INT64>>[{1}]
==
[prepare_database]
CREATE TEMP FUNCTION One() AS ( 1 );
==
[prepare_database]
CREATE TEMP VIEW SelectOne SQL SECURITY INVOKER AS SELECT 1 AS a;
==
[prepare_database]
CREATE TEMP VIEW ViewWithUdf SQL SECURITY INVOKER AS SELECT One() AS a;
==
[prepare_database]
CREATE TEMP TABLE T2 AS SELECT 2 as b;
--
ARRAY<STRUCT<b INT64>>[{2}]
==
[name=invoke_trival_view]
SELECT * FROM SelectOne;
--
ARRAY<STRUCT<a INT64>>[{1}]
==
[name=invoke_view_with_udf]
SELECT * FROM ViewWithUdf;
--
ARRAY<STRUCT<a INT64>>[{1}]
