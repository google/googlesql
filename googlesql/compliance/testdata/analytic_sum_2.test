[prepare_database]
CREATE TABLE TestTable AS
SELECT cast(1 as int64) as row_id,
       cast(null as bool) as bool_val,
       cast(null as int64) as int64_val,
       cast(null as uint64) as uint64_val,
       cast(null as double) as double_val UNION ALL
  SELECT 2,  true,  2,    3,    1.5  UNION ALL
  SELECT 3,  false, 1,    6,    1.5  UNION ALL
  SELECT 4,  true,  null, 2,    2.5  UNION ALL
  SELECT 5,  false, 1,    null, 3.5  UNION ALL
  SELECT 6,  true,  2,    2,    null UNION ALL
  SELECT 7,  false, 1,    5,    -0.5 UNION ALL
  SELECT 8,  true,  4,    2,    -1.5 UNION ALL
  SELECT 9,  false, 2,    3,    1.5  UNION ALL
  SELECT 10, true,  3,    1,    2.5
--
ARRAY<STRUCT<row_id INT64,
             bool_val BOOL,
             int64_val INT64,
             uint64_val UINT64,
             double_val DOUBLE>>
[
  {1, NULL, NULL, NULL, NULL},
  {2, true, 2, 3, 1.5},
  {3, false, 1, 6, 1.5},
  {4, true, NULL, 2, 2.5},
  {5, false, 1, NULL, 3.5},
  {6, true, 2, 2, NULL},
  {7, false, 1, 5, -0.5},
  {8, true, 4, 2, -1.5},
  {9, false, 2, 3, 1.5},
  {10, true, 3, 1, 2.5}
]
==


[default required_features=ANALYTIC_FUNCTIONS]
[name=first_partition_has_single_row_with_large_order_key]
[labels=analytic_sum_over_range_between_unbounded_and_following]
SELECT partition_col, order_col,
       SUM(10) OVER (PARTITION BY partition_col ORDER BY order_col
                     RANGE BETWEEN UNBOUNDED PRECEDING AND
                                   10 FOLLOWING)
FROM (
  SELECT 1 partition_col, 100 order_col UNION ALL
  SELECT 2,               1             UNION ALL
  SELECT 2,               2             UNION ALL
  SELECT 2,               3             UNION ALL
  SELECT 2,               4             UNION ALL
  SELECT 3,               -100          UNION ALL
  SELECT 3,               -99
)
--
ARRAY<STRUCT<partition_col INT64, order_col INT64, INT64>>[unknown order:
  {1, 100, 10},
  {2, 1, 40},
  {2, 2, 40},
  {2, 3, 40},
  {2, 4, 40},
  {3, -100, 20},
  {3, -99, 20}
]
==

[name=first_partition_has_multi_rows_with_large_last_order_key]
[labels=analytic_sum_over_range_between_unbounded_and_following]
SELECT partition_col, order_col,
       SUM(10) OVER (PARTITION BY partition_col ORDER BY order_col
                     RANGE BETWEEN UNBOUNDED PRECEDING AND
                                   10 FOLLOWING)
FROM (
  SELECT 1 partition_col, NULL order_col UNION ALL
  SELECT 1,               0              UNION ALL
  SELECT 1,               100            UNION ALL
  SELECT 2,               1              UNION ALL
  SELECT 2,               2              UNION ALL
  SELECT 2,               3              UNION ALL
  SELECT 2,               4              UNION ALL
  SELECT 3,               -100           UNION ALL
  SELECT 3,               -99
)
--
ARRAY<STRUCT<partition_col INT64, order_col INT64, INT64>>[unknown order:
  {1, NULL, 10},
  {1, 0, 20},
  {1, 100, 30},
  {2, 1, 40},
  {2, 2, 40},
  {2, 3, 40},
  {2, 4, 40},
  {3, -100, 20},
  {3, -99, 20}
]
==

[name=analytic_sum_range_current_and_current]
[labels=analytic_sum_over_range_between_current_and_current]
SELECT bool_val, int64_val, double_val,
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val
                             RANGE BETWEEN CURRENT ROW AND CURRENT ROW),
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val desc
                             RANGE BETWEEN CURRENT ROW AND CURRENT ROW)
FROM TestTable
--
ARRAY<STRUCT<bool_val BOOL, int64_val INT64, double_val DOUBLE, DOUBLE, DOUBLE>>[unknown order:
  {NULL, NULL, NULL, NULL, NULL},
  {false, 2, 1.5, 1.5, 1.5},
  {false, 1, 3.5, 4.5, 4.5},
  {false, 1, -0.5, 4.5, 4.5},
  {false, 1, 1.5, 4.5, 4.5},
  {true, 4, -1.5, -1.5, -1.5},
  {true, 3, 2.5, 2.5, 2.5},
  {true, 2, 1.5, 1.5, 1.5},
  {true, 2, NULL, 1.5, 1.5},
  {true, NULL, 2.5, 2.5, 2.5}
]
==

[name=analytic_sum_range_preceding_and_unbounded]
[labels=analytic_sum_over_range_between_preceding_and_unbounded]
SELECT bool_val, int64_val, double_val,
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val
                             RANGE BETWEEN 2 PRECEDING AND UNBOUNDED FOLLOWING),
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val
                             RANGE BETWEEN 0 PRECEDING AND UNBOUNDED FOLLOWING),
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val
                             RANGE BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING),
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val desc
                             RANGE BETWEEN 2 PRECEDING AND UNBOUNDED FOLLOWING)
FROM TestTable
--
ARRAY<STRUCT<bool_val BOOL,
             int64_val INT64,
             double_val DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE>>
[unknown order:
  {NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {false, 2, 1.5, 6, 1.5, 6, 6},
  {false, 1, 3.5, 6, 6, 6, 6},
  {false, 1, -0.5, 6, 6, 6, 6},
  {false, 1, 1.5, 6, 6, 6, 6},
  {true, 4, -1.5, 2.5, -1.5, 1, 5},
  {true, 3, 2.5, 2.5, 1, 2.5, 5},
  {true, 2, 1.5, 2.5, 2.5, 2.5, 5},
  {true, 2, NULL, 2.5, 2.5, 2.5, 5},
  {true, NULL, 2.5, 5, 5, 5, 2.5}
]
==

[name=analytic_sum_range_current_and_unbounded]
[labels=analytic_sum_over_range_between_current_and_unbounded]
SELECT bool_val, int64_val, double_val,
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val
                             RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING),
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val desc
                             RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
FROM TestTable
--
ARRAY<STRUCT<bool_val BOOL, int64_val INT64, double_val DOUBLE, DOUBLE, DOUBLE>>[unknown order:
  {NULL, NULL, NULL, NULL, NULL},
  {false, 2, 1.5, 1.5, 6},
  {false, 1, 3.5, 6, 4.5},
  {false, 1, -0.5, 6, 4.5},
  {false, 1, 1.5, 6, 4.5},
  {true, 4, -1.5, -1.5, 5},
  {true, 3, 2.5, 1, 6.5},
  {true, 2, 1.5, 2.5, 4},
  {true, 2, NULL, 2.5, 4},
  {true, NULL, 2.5, 5, 2.5}
]
==

[name=analytic_sum_range_following_and_unbounded]
[labels=analytic_sum_over_range_between_following_and_unbounded]
SELECT bool_val, int64_val, double_val,
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val
                             RANGE BETWEEN 2 FOLLOWING AND UNBOUNDED FOLLOWING),
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val
                             RANGE BETWEEN 0 FOLLOWING AND UNBOUNDED FOLLOWING),
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val
                             RANGE BETWEEN 1 FOLLOWING AND UNBOUNDED FOLLOWING),
       SUM(double_val) OVER (PARTITION BY bool_val ORDER BY int64_val desc
                             RANGE BETWEEN 2 FOLLOWING AND UNBOUNDED FOLLOWING)
FROM TestTable
--
ARRAY<STRUCT<bool_val BOOL,
             int64_val INT64,
             double_val DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE,
             DOUBLE>>
[unknown order:
  {NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {false, 2, 1.5, NULL, 1.5, NULL, NULL},
  {false, 1, 3.5, NULL, 6, 1.5, NULL},
  {false, 1, -0.5, NULL, 6, 1.5, NULL},
  {false, 1, 1.5, NULL, 6, 1.5, NULL},
  {true, 4, -1.5, NULL, -1.5, NULL, 4},
  {true, 3, 2.5, NULL, 1, -1.5, 2.5},
  {true, 2, 1.5, -1.5, 2.5, 1, 2.5},
  {true, 2, NULL, -1.5, 2.5, 1, 2.5},
  {true, NULL, 2.5, 5, 5, 5, 2.5}
]
==

# ROWS window frame : ROWS BETWEEN <offset> PRECEDING AND CURRENT ROW
[name=analytic_sum_rows_preceding_and_current]
[labels=analytic_sum_over_rows_between_preceding_and_current]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 0 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 1 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 3 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 4 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 7 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 8 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 9 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 10 PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 11 PRECEDING
                                                       AND CURRENT ROW)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64,
             row_id INT64,
             val INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64>>
[known order:{1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3},
             {1, 3, 2, 2, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5},
             {1, 7, 3, 3, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8},
             {1, 8, 6, 6, 9, 11, 14, 14, 14, 14, 14, 14, 14, 14, 14},
             {1, 11, 3, 3, 9, 12, 14, 17, 17, 17, 17, 17, 17, 17, 17},
             {1, 13, 2, 2, 5, 11, 14, 16, 19, 19, 19, 19, 19, 19, 19},
             {1, 17, 3, 3, 5, 8, 14, 17, 19, 22, 22, 22, 22, 22, 22},
             {1, 18, 6, 6, 9, 11, 14, 20, 23, 25, 28, 28, 28, 28, 28},
             {2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
             {2, 5, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
             {2, 9, NULL, NULL, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
             {2, 12, 1, 1, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3},
             {2, 15, 1, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4},
             {2, 19, NULL, NULL, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4},
             {3,
              4,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {3, 6, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3},
             {3, 10, 5, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8},
             {3, 14, NULL, NULL, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8},
             {3, 16, 3, 3, 3, 8, 11, 11, 11, 11, 11, 11, 11, 11, 11},
             {3, 20, 5, 5, 8, 8, 13, 16, 16, 16, 16, 16, 16, 16, 16}]
==

# ROWS window frame : ROWS BETWEEN CURRENT ROW AND <offset> FOLLOWING
[name=analytic_sum_rows_current_and_following_with_diff_following_offset]
[labels=analytic_sum_over_rows_between_current_and_following]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 0 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 1 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 3 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 4 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 5 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 6 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 7 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 8 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 9 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 10 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND 11 FOLLOWING)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64,
             row_id INT64,
             val INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64>>
[known order:{1, 1, 3, 3, 5, 8, 14, 17, 19, 22, 28, 28, 28, 28, 28},
             {1, 3, 2, 2, 5, 11, 14, 16, 19, 25, 25, 25, 25, 25, 25},
             {1, 7, 3, 3, 9, 12, 14, 17, 23, 23, 23, 23, 23, 23, 23},
             {1, 8, 6, 6, 9, 11, 14, 20, 20, 20, 20, 20, 20, 20, 20},
             {1, 11, 3, 3, 5, 8, 14, 14, 14, 14, 14, 14, 14, 14, 14},
             {1, 13, 2, 2, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11},
             {1, 17, 3, 3, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9},
             {1, 18, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6},
             {2, 2, 1, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4},
             {2, 5, 1, 1, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3},
             {2, 9, NULL, NULL, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
             {2, 12, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
             {2, 15, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
             {2,
              19,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {3, 4, NULL, NULL, 3, 8, 8, 11, 16, 16, 16, 16, 16, 16, 16},
             {3, 6, 3, 3, 8, 8, 11, 16, 16, 16, 16, 16, 16, 16, 16},
             {3, 10, 5, 5, 5, 8, 13, 13, 13, 13, 13, 13, 13, 13, 13},
             {3, 14, NULL, NULL, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8},
             {3, 16, 3, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8},
             {3, 20, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5}]
==

# ROWS window frame : ROWS BETWEEN CURRENT ROW AND CURRENT ROW
[name=analytic_sum_rows_current_and_current]
[labels=analytic_sum_over_rows_between_current_and_current]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND CURRENT ROW)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64, row_id INT64, val INT64, INT64>>[known order:
  {1, 1, 3, 3},
  {1, 3, 2, 2},
  {1, 7, 3, 3},
  {1, 8, 6, 6},
  {1, 11, 3, 3},
  {1, 13, 2, 2},
  {1, 17, 3, 3},
  {1, 18, 6, 6},
  {2, 2, 1, 1},
  {2, 5, 1, 1},
  {2, 9, NULL, NULL},
  {2, 12, 1, 1},
  {2, 15, 1, 1},
  {2, 19, NULL, NULL},
  {3, 4, NULL, NULL},
  {3, 6, 3, 3},
  {3, 10, 5, 5},
  {3, 14, NULL, NULL},
  {3, 16, 3, 3},
  {3, 20, 5, 5}
]
==

# ROWS window frame : ROWS BETWEEN <offset> PRECEDING AND <offset> FOLLOWING
[name=analytic_sum_rows_preceding_and_following_with_diff_following_offset]
[labels=analytic_sum_over_rows_between_preceding_and_following]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 0 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 1 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 3 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 4 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 5 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 6 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 7 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 8 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 9 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 10 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 11 FOLLOWING)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64,
             row_id INT64,
             val INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64>>
[known order:
  {1, 1, 3, 3, 5, 8, 14, 17, 19, 22, 28, 28, 28, 28, 28},
  {1, 3, 2, 5, 8, 14, 17, 19, 22, 28, 28, 28, 28, 28, 28},
  {1, 7, 3, 8, 14, 17, 19, 22, 28, 28, 28, 28, 28, 28, 28},
  {1, 8, 6, 11, 14, 16, 19, 25, 25, 25, 25, 25, 25, 25, 25},
  {1, 11, 3, 12, 14, 17, 23, 23, 23, 23, 23, 23, 23, 23, 23},
  {1, 13, 2, 11, 14, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20},
  {1, 17, 3, 8, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14},
  {1, 18, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11},
  {2, 2, 1, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 5, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 9, NULL, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 12, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3},
  {2, 15, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
  {2, 19, NULL, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
  {3, 4, NULL, NULL, 3, 8, 8, 11, 16, 16, 16, 16, 16, 16, 16},
  {3, 6, 3, 3, 8, 8, 11, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 10, 5, 8, 8, 11, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 14, NULL, 8, 11, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 16, 3, 8, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13},
  {3, 20, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8}
]
==

# ROWS window frame : ROWS BETWEEN <offset> PRECEDING AND <offset> FOLLOWING
[name=analytic_sum_rows_preceding_and_following_with_diff_preceding_offset]
[labels=analytic_sum_over_rows_between_preceding_and_following]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 0 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 1 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 3 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 4 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 7 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 8 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 9 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 10 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 11 PRECEDING
                                                       AND 2 FOLLOWING)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64,
             row_id INT64,
             val INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64>>
[known order:
  {1, 1, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8},
  {1, 3, 2, 11, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14},
  {1, 7, 3, 12, 14, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17},
  {1, 8, 6, 11, 14, 16, 19, 19, 19, 19, 19, 19, 19, 19, 19},
  {1, 11, 3, 8, 14, 17, 19, 22, 22, 22, 22, 22, 22, 22, 22},
  {1, 13, 2, 11, 14, 20, 23, 25, 28, 28, 28, 28, 28, 28, 28},
  {1, 17, 3, 9, 11, 14, 20, 23, 25, 28, 28, 28, 28, 28, 28},
  {1, 18, 6, 6, 9, 11, 14, 20, 23, 25, 28, 28, 28, 28, 28},
  {2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
  {2, 5, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3},
  {2, 9, NULL, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 12, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 15, 1, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 19, NULL, NULL, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4},
  {3, 4, NULL, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8},
  {3, 6, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8},
  {3, 10, 5, 8, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11},
  {3, 14, NULL, 8, 13, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 16, 3, 8, 8, 13, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 20, 5, 5, 8, 8, 13, 16, 16, 16, 16, 16, 16, 16, 16}
]
==

# ROWS window frame : ROWS BETWEEN <offset> PRECEDING AND <offset> FOLLOWING
[name=analytic_sum_rows_preceding_and_following_with_diff_preceding_and_following_offset]
[labels=analytic_sum_over_rows_between_preceding_and_following]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 0 PRECEDING
                                                       AND 0 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 1 PRECEDING
                                                       AND 1 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 3 PRECEDING
                                                       AND 3 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 4 PRECEDING
                                                       AND 4 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 PRECEDING
                                                       AND 5 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 PRECEDING
                                                       AND 6 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 7 PRECEDING
                                                       AND 7 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 8 PRECEDING
                                                       AND 8 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 9 PRECEDING
                                                       AND 9 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 10 PRECEDING
                                                       AND 10 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 11 PRECEDING
                                                       AND 11 FOLLOWING)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64,
             row_id INT64,
             val INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64>>
[known order:
  {1, 1, 3, 3, 5, 8, 14, 17, 19, 22, 28, 28, 28, 28, 28},
  {1, 3, 2, 2, 8, 14, 17, 19, 22, 28, 28, 28, 28, 28, 28},
  {1, 7, 3, 3, 11, 17, 19, 22, 28, 28, 28, 28, 28, 28, 28},
  {1, 8, 6, 6, 12, 16, 22, 28, 28, 28, 28, 28, 28, 28, 28},
  {1, 11, 3, 3, 11, 17, 25, 28, 28, 28, 28, 28, 28, 28, 28},
  {1, 13, 2, 2, 8, 20, 23, 25, 28, 28, 28, 28, 28, 28, 28},
  {1, 17, 3, 3, 11, 14, 20, 23, 25, 28, 28, 28, 28, 28, 28},
  {1, 18, 6, 6, 9, 11, 14, 20, 23, 25, 28, 28, 28, 28, 28},
  {2, 2, 1, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 5, 1, 1, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 9, NULL, NULL, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 12, 1, 1, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 15, 1, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 19, NULL, NULL, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4},
  {3, 4, NULL, NULL, 3, 8, 8, 11, 16, 16, 16, 16, 16, 16, 16},
  {3, 6, 3, 3, 8, 8, 11, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 10, 5, 5, 8, 11, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 14, NULL, NULL, 8, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 16, 3, 3, 8, 13, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 20, 5, 5, 8, 8, 13, 16, 16, 16, 16, 16, 16, 16, 16}
]
==

# ROWS window frame : ROWS BETWEEN <offset> PRECEDING AND UNBOUNDED FOLLOWING
[name=analytic_sum_rows_preceding_and_unbounded_with_diff_preceding_offset]
[labels=analytic_sum_over_rows_between_preceding_and_unbounded,analytic_sum_over_rows_between_current_and_unbounded]

select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 0 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 1 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 3 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 4 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 7 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 8 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 9 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 10 PRECEDING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 11 PRECEDING
                                                       AND UNBOUNDED FOLLOWING)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64,
             row_id INT64,
             val INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64>>
[known order:
  {1, 1, 3, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28},
  {1, 3, 2, 25, 25, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28},
  {1, 7, 3, 23, 23, 25, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28},
  {1, 8, 6, 20, 20, 23, 25, 28, 28, 28, 28, 28, 28, 28, 28, 28},
  {1, 11, 3, 14, 14, 20, 23, 25, 28, 28, 28, 28, 28, 28, 28, 28},
  {1, 13, 2, 11, 11, 14, 20, 23, 25, 28, 28, 28, 28, 28, 28, 28},
  {1, 17, 3, 9, 9, 11, 14, 20, 23, 25, 28, 28, 28, 28, 28, 28},
  {1, 18, 6, 6, 6, 9, 11, 14, 20, 23, 25, 28, 28, 28, 28, 28},
  {2, 2, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 5, 1, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 9, NULL, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 12, 1, 2, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 15, 1, 1, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4},
  {2, 19, NULL, NULL, NULL, 1, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4},
  {3, 4, NULL, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 6, 3, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 10, 5, 13, 13, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 14, NULL, 8, 8, 13, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 16, 3, 8, 8, 8, 13, 16, 16, 16, 16, 16, 16, 16, 16, 16},
  {3, 20, 5, 5, 5, 8, 8, 13, 16, 16, 16, 16, 16, 16, 16, 16}
]
==

# ROWS window frame : ROWS BETWEEN <offset> FOLLOWING AND UNBOUNDED FOLLOWING
[name=analytic_sum_rows_following_and_unbounded_with_diff_following_offset]
[labels=analytic_sum_over_rows_between_following_and_unbounded]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 0 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 1 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 3 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 4 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 7 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 8 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 9 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 10 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 11 FOLLOWING
                                                       AND UNBOUNDED FOLLOWING)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64,
             row_id INT64,
             val INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64>>
[known order:
  {1, 1, 3, 28, 28, 25, 23, 20, 14, 11, 9, 6, NULL, NULL, NULL, NULL},
  {1, 3, 2, 25, 25, 23, 20, 14, 11, 9, 6, NULL, NULL, NULL, NULL, NULL},
  {1, 7, 3, 23, 23, 20, 14, 11, 9, 6, NULL, NULL, NULL, NULL, NULL, NULL},
  {1, 8, 6, 20, 20, 14, 11, 9, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {1, 11, 3, 14, 14, 11, 9, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {1, 13, 2, 11, 11, 9, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {1,
   17,
   3,
   9,
   9,
   6,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {1,
   18,
   6,
   6,
   6,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {2, 2, 1, 4, 4, 3, 2, 2, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {2, 5, 1, 3, 3, 2, 2, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {2, 9, NULL, 2, 2, 2, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {2,
   12,
   1,
   2,
   2,
   1,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {2,
   15,
   1,
   1,
   1,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {2,
   19,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {3, 4, NULL, 16, 16, 16, 13, 8, 8, 5, NULL, NULL, NULL, NULL, NULL, NULL},
  {3, 6, 3, 16, 16, 13, 8, 8, 5, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {3, 10, 5, 13, 13, 8, 8, 5, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
  {3,
   14,
   NULL,
   8,
   8,
   8,
   5,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {3,
   16,
   3,
   8,
   8,
   5,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {3,
   20,
   5,
   5,
   5,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL}
]
==

# ROWS window frame : ROWS BETWEEN <offset> FOLLOWING AND <offset> FOLLOWING
[name=analytic_sum_rows_following_and_following_with_diff_following_offset]
[labels=analytic_sum_over_rows_between_following_and_following]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN CURRENT ROW
                                                       AND UNBOUNDED FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 0 FOLLOWING
                                                       AND 0 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 1 FOLLOWING
                                                       AND 2 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 FOLLOWING
                                                       AND 4 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 3 FOLLOWING
                                                       AND 6 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 4 FOLLOWING
                                                       AND 8 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 FOLLOWING
                                                       AND 10 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 FOLLOWING
                                                       AND 12 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 7 FOLLOWING
                                                       AND 14 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 3 FOLLOWING
                                                       AND 5 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 4 FOLLOWING
                                                       AND 6 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 FOLLOWING
                                                       AND 7 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 FOLLOWING
                                                       AND 8 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 FOLLOWING
                                                       AND 3 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 FOLLOWING
                                                       AND 4 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 FOLLOWING
                                                       AND 0 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 FOLLOWING
                                                       AND 5 FOLLOWING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 9 FOLLOWING
                                                       AND 9 FOLLOWING)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64,
             row_id INT64,
             val INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64>>
[known order:{1,
              1,
              3,
              28,
              3,
              5,
              12,
              14,
              14,
              11,
              9,
              6,
              11,
              8,
              11,
              9,
              NULL,
              NULL,
              NULL,
              2,
              NULL},
             {1,
              3,
              2,
              25,
              2,
              9,
              11,
              14,
              11,
              9,
              6,
              NULL,
              8,
              11,
              9,
              6,
              NULL,
              NULL,
              NULL,
              3,
              NULL},
             {1,
              7,
              3,
              23,
              3,
              9,
              8,
              11,
              9,
              6,
              NULL,
              NULL,
              11,
              9,
              6,
              NULL,
              NULL,
              NULL,
              NULL,
              6,
              NULL},
             {1,
              8,
              6,
              20,
              6,
              5,
              11,
              9,
              6,
              NULL,
              NULL,
              NULL,
              9,
              6,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {1,
              11,
              3,
              14,
              3,
              5,
              9,
              6,
              NULL,
              NULL,
              NULL,
              NULL,
              6,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {1,
              13,
              2,
              11,
              2,
              9,
              6,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {1,
              17,
              3,
              9,
              3,
              6,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {1,
              18,
              6,
              6,
              6,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {2,
              2,
              1,
              4,
              1,
              1,
              2,
              2,
              1,
              NULL,
              NULL,
              NULL,
              2,
              1,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {2,
              5,
              1,
              3,
              1,
              1,
              2,
              1,
              NULL,
              NULL,
              NULL,
              NULL,
              1,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {2,
              9,
              NULL,
              2,
              NULL,
              2,
              1,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {2,
              12,
              1,
              2,
              1,
              1,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {2,
              15,
              1,
              1,
              1,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {2,
              19,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {3,
              4,
              NULL,
              16,
              NULL,
              8,
              8,
              8,
              8,
              5,
              NULL,
              NULL,
              8,
              8,
              5,
              NULL,
              NULL,
              NULL,
              NULL,
              5,
              NULL},
             {3,
              6,
              3,
              16,
              3,
              5,
              8,
              8,
              5,
              NULL,
              NULL,
              NULL,
              8,
              5,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {3,
              10,
              5,
              13,
              5,
              3,
              8,
              5,
              NULL,
              NULL,
              NULL,
              NULL,
              5,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {3,
              14,
              NULL,
              8,
              NULL,
              8,
              5,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {3,
              16,
              3,
              8,
              3,
              5,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL},
             {3,
              20,
              5,
              5,
              5,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL,
              NULL}]
==

# ROWS window frame : ROWS BETWEEN <offset> PRECEDING AND <offset> PRECEDING
[name=analytic_sum_rows_preceding_and_preceding_with_diff_preceding_offset]
[labels=analytic_sum_over_rows_between_preceding_and_preceding]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 0 PRECEDING
                                                       AND 0 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 2 PRECEDING
                                                       AND 1 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 4 PRECEDING
                                                       AND 2 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 PRECEDING
                                                       AND 3 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 8 PRECEDING
                                                       AND 4 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 10 PRECEDING
                                                       AND 5 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 12 PRECEDING
                                                       AND 6 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 14 PRECEDING
                                                       AND 7 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 PRECEDING
                                                       AND 3 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 6 PRECEDING
                                                       AND 4 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 7 PRECEDING
                                                       AND 5 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 8 PRECEDING
                                                       AND 6 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 3 PRECEDING
                                                       AND 5 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 4 PRECEDING
                                                       AND 6 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 0 PRECEDING
                                                       AND 5 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 5 PRECEDING
                                                       AND 5 PRECEDING),
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN 9 PRECEDING
                                                       AND 9 PRECEDING)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64,
             row_id INT64,
             val INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64,
             INT64>>
[known order:
  {1,
   1,
   3,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {1,
   3,
   2,
   2,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {1,
   7,
   3,
   3,
   5,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {1,
   8,
   6,
   6,
   5,
   5,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {1,
   11,
   3,
   3,
   9,
   8,
   5,
   3,
   NULL,
   NULL,
   NULL,
   5,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {1,
   13,
   2,
   2,
   9,
   11,
   8,
   5,
   3,
   NULL,
   NULL,
   8,
   5,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   3,
   NULL},
  {1,
   17,
   3,
   3,
   5,
   12,
   14,
   8,
   5,
   3,
   NULL,
   11,
   8,
   5,
   3,
   NULL,
   NULL,
   NULL,
   2,
   NULL},
  {1, 18, 6, 6, 5, 11, 14, 14, 8, 5, 3, 12, 11, 8, 5, NULL, NULL, NULL, 3, NULL},
  {2,
   2,
   1,
   1,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {2,
   5,
   1,
   1,
   1,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {2,
   9,
   NULL,
   NULL,
   2,
   1,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {2,
   12,
   1,
   1,
   1,
   2,
   1,
   NULL,
   NULL,
   NULL,
   NULL,
   1,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {2,
   15,
   1,
   1,
   1,
   2,
   2,
   1,
   NULL,
   NULL,
   NULL,
   2,
   1,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {2,
   19,
   NULL,
   NULL,
   2,
   2,
   2,
   2,
   1,
   NULL,
   NULL,
   2,
   2,
   1,
   NULL,
   NULL,
   NULL,
   NULL,
   1,
   NULL},
  {3,
   4,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {3,
   6,
   3,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {3,
   10,
   5,
   5,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {3,
   14,
   NULL,
   NULL,
   8,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {3,
   16,
   3,
   3,
   5,
   8,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {3,
   20,
   5,
   5,
   3,
   8,
   8,
   3,
   NULL,
   NULL,
   NULL,
   8,
   3,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL}
]
==

# ROWS window frame : ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
[name=analytic_sum_rows_unbounded_and_current_row]
[labels=analytic_sum_over_rows_between_unbounded_and_current_row]
select part, row_id, val,
       sum(val) over (partition by part order by row_id
                                              ROWS BETWEEN UNBOUNDED PRECEDING
                                                       AND CURRENT ROW),
       sum(val) over (partition by part order by row_id desc
                                              ROWS BETWEEN UNBOUNDED PRECEDING
                                                       AND CURRENT ROW)
FROM (SELECT 1 row_id, 3 val, 1 part UNION ALL
      SELECT 2,  1,    2             UNION ALL
      SELECT 3,  2,    1             UNION ALL
      SELECT 4,  NULL, 3             UNION ALL
      SELECT 5,  1,    2             UNION ALL
      SELECT 6,  3,    3             UNION ALL
      SELECT 7,  3,    1             UNION ALL
      SELECT 8,  6,    1             UNION ALL
      SELECT 9,  NULL, 2             UNION ALL
      SELECT 10, 5,    3             UNION ALL
      SELECT 11, 3,    1             UNION ALL
      SELECT 12, 1,    2             UNION ALL
      SELECT 13, 2,    1             UNION ALL
      SELECT 14, NULL, 3             UNION ALL
      SELECT 15, 1,    2             UNION ALL
      SELECT 16, 3,    3             UNION ALL
      SELECT 17, 3,    1             UNION ALL
      SELECT 18, 6,    1             UNION ALL
      SELECT 19, NULL, 2             UNION ALL
      SELECT 20, 5,    3)
order by part, row_id, val
--
ARRAY<STRUCT<part INT64, row_id INT64, val INT64, INT64, INT64>>[known order:
  {1, 1, 3, 3, 28},
  {1, 3, 2, 5, 25},
  {1, 7, 3, 8, 23},
  {1, 8, 6, 14, 20},
  {1, 11, 3, 17, 14},
  {1, 13, 2, 19, 11},
  {1, 17, 3, 22, 9},
  {1, 18, 6, 28, 6},
  {2, 2, 1, 1, 4},
  {2, 5, 1, 2, 3},
  {2, 9, NULL, 2, 2},
  {2, 12, 1, 3, 2},
  {2, 15, 1, 4, 1},
  {2, 19, NULL, 4, NULL},
  {3, 4, NULL, NULL, 16},
  {3, 6, 3, 3, 16},
  {3, 10, 5, 8, 13},
  {3, 14, NULL, 8, 8},
  {3, 16, 3, 11, 8},
  {3, 20, 5, 16, 5}
]
