[default required_features=TABLE_VALUED_FUNCTIONS,CREATE_TABLE_FUNCTION,TEMPLATE_FUNCTIONS,TOP_LEVEL_TABLE_STATEMENTS]
[prepare_database]
CREATE TABLE t1 AS
  SELECT * FROM UNNEST([
    STRUCT(1 AS key, "Hello" AS value),
    STRUCT(2 AS key, "World" AS value)
    ]);
--
ARRAY<STRUCT<key INT64, value STRING>>[{2, "World"}, {1, "Hello"}]
==

[prepare_database]
CREATE TABLE t2 AS
  SELECT * FROM UNNEST([
    STRUCT(3 AS key, "Hi-ya" AS value),
    STRUCT(4 AS key, "Universe" AS value)
    ]);
--
ARRAY<STRUCT<key INT64, value STRING>>[{4, "Universe"}, {3, "Hi-ya"}]
==

[prepare_database]
CREATE TABLE FUNCTION tvf(t ANY TABLE)
AS (
  TABLE t
);
==

[name=top_level_table_statement]
TABLE t1;
--
ARRAY<STRUCT<key INT64, value STRING>>[unknown order:
  {2, "World"},
  {1, "Hello"}
]
==

[name=top_level_table_statement_order_by]
TABLE t1 ORDER BY value;
--
ARRAY<STRUCT<key INT64, value STRING>>[known order:{1, "Hello"}, {2, "World"}]
==

[name=top_level_table_statement_union_all]
TABLE t1 UNION ALL TABLE t2;
--
ARRAY<STRUCT<key INT64, value STRING>>[unknown order:
  {1, "Hello"},
  {2, "World"},
  {3, "Hi-ya"},
  {4, "Universe"}
]
==

[name=top_level_table_statement_with_tvf_and_limit]
TABLE tvf(TABLE t1) ORDER BY key LIMIT 1;
--
ARRAY<STRUCT<key INT64, value STRING>>[{1, "Hello"}]
==

[name=top_level_table_statement_union_all_order_by_limit]
TABLE t1 UNION ALL TABLE tvf(TABLE t1) ORDER BY value LIMIT 3;
--
ARRAY<STRUCT<key INT64, value STRING>>[known order:
  {1, "Hello"},
  {1, "Hello"},
  {2, "World"}
]

