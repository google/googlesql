[default required_features=RANGE_TYPE]

[name=range_is_start_unbounded_of_range_of_dates]
SELECT RANGE_IS_START_UNBOUNDED(RANGE<DATE> '[2014-01-01, 2015-01-01)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATE> '[2014-01-01, UNBOUNDED)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATE> '[UNBOUNDED, 2015-01-01)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATE> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL, BOOL>>[{false, false, true, true}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_is_start_unbounded_of_range_of_datetimes]
SELECT RANGE_IS_START_UNBOUNDED(RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATETIME> '[2016-01-01 12:00:00, UNBOUNDED)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATETIME> '[UNBOUNDED, 2017-01-01 12:00:00)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATETIME> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL, BOOL>>[{false, false, true, true}]
==

[name=range_is_start_unbounded_of_range_of_timestamps]
SELECT RANGE_IS_START_UNBOUNDED(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)'),
       RANGE_IS_START_UNBOUNDED(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, UNBOUNDED)'),
       RANGE_IS_START_UNBOUNDED(RANGE<TIMESTAMP> '[UNBOUNDED, 2019-01-01 12:00:00+08)'),
       RANGE_IS_START_UNBOUNDED(RANGE<TIMESTAMP> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL, BOOL>>[{false, false, true, true}]
==

[name=range_is_start_unbounded_of_range_of_dates_with_null]
SELECT RANGE_IS_START_UNBOUNDED(RANGE<DATE> '[2014-01-01, NULL)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATE> '[NULL, 2015-01-01)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATE> '[NULL, NULL)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL>>[{false, true, true}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_is_start_unbounded_of_range_of_datetimes_with_null]
SELECT RANGE_IS_START_UNBOUNDED(RANGE<DATETIME> '[2016-01-01 12:00:00, NULL)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATETIME> '[NULL, 2017-01-01 12:00:00)'),
       RANGE_IS_START_UNBOUNDED(RANGE<DATETIME> '[NULL, NULL)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL>>[{false, true, true}]
==

[name=range_is_start_unbounded_of_range_of_timestamps_with_null]
SELECT RANGE_IS_START_UNBOUNDED(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, NULL)'),
       RANGE_IS_START_UNBOUNDED(RANGE<TIMESTAMP> '[NULL, 2019-01-01 12:00:00+08)'),
       RANGE_IS_START_UNBOUNDED(RANGE<TIMESTAMP> '[NULL, NULL)')
--
ARRAY<STRUCT<BOOL, BOOL, BOOL>>[{false, true, true}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_is_start_unbounded_of_range_of_casted_null]
SELECT RANGE_IS_START_UNBOUNDED(CAST(NULL AS RANGE<DATE>)),
       RANGE_IS_START_UNBOUNDED(CAST(NULL AS RANGE<DATETIME>)),
       RANGE_IS_START_UNBOUNDED(CAST(NULL AS RANGE<TIMESTAMP>));
--
ARRAY<STRUCT<BOOL, BOOL, BOOL>>[{NULL, NULL, NULL}]
==

[required_features=RANGE_TYPE,CIVIL_TIME,INLINE_LAMBDA_ARGUMENT]
[name=range_is_start_unbounded_with_array_transform_array_struct_and_lambda]
SELECT ARRAY_TRANSFORM([STRUCT (RANGE<DATE> '[2014-01-01, 2015-01-01)' AS r)], e -> RANGE_IS_START_UNBOUNDED(e.r)),
       ARRAY_TRANSFORM([STRUCT (RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)' AS r)], e -> RANGE_IS_START_UNBOUNDED(e.r)),
       ARRAY_TRANSFORM([STRUCT (RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)' AS r)], e -> RANGE_IS_START_UNBOUNDED(e.r));
--
ARRAY<STRUCT<ARRAY<>, ARRAY<>, ARRAY<>>>[
  {ARRAY<BOOL>[false], ARRAY<BOOL>[false], ARRAY<BOOL>[false]}
]
==

[name=range_is_end_unbounded_of_range_of_dates]
SELECT RANGE_IS_END_UNBOUNDED(RANGE<DATE> '[2014-01-01, 2015-01-01)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATE> '[2014-01-01, UNBOUNDED)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATE> '[UNBOUNDED, 2015-01-01)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATE> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL, BOOL>>[{false, true, false, true}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_is_end_unbounded_of_range_of_datetimes]
SELECT RANGE_IS_END_UNBOUNDED(RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATETIME> '[2016-01-01 12:00:00, UNBOUNDED)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATETIME> '[UNBOUNDED, 2017-01-01 12:00:00)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATETIME> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL, BOOL>>[{false, true, false, true}]
==

[name=range_is_end_unbounded_of_range_of_timestamps]
SELECT RANGE_IS_END_UNBOUNDED(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)'),
       RANGE_IS_END_UNBOUNDED(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, UNBOUNDED)'),
       RANGE_IS_END_UNBOUNDED(RANGE<TIMESTAMP> '[UNBOUNDED, 2019-01-01 12:00:00+08)'),
       RANGE_IS_END_UNBOUNDED(RANGE<TIMESTAMP> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL, BOOL>>[{false, true, false, true}]
==

[name=range_is_end_unbounded_of_range_of_dates_with_null]
SELECT RANGE_IS_END_UNBOUNDED(RANGE<DATE> '[2014-01-01, NULL)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATE> '[NULL, 2015-01-01)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATE> '[NULL, NULL)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL>>[{true, false, true}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_is_end_unbounded_of_range_of_datetimes_with_null]
SELECT RANGE_IS_END_UNBOUNDED(RANGE<DATETIME> '[2016-01-01 12:00:00, NULL)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATETIME> '[NULL, 2017-01-01 12:00:00)'),
       RANGE_IS_END_UNBOUNDED(RANGE<DATETIME> '[NULL, NULL)');
--
ARRAY<STRUCT<BOOL, BOOL, BOOL>>[{true, false, true}]
==

[name=range_is_end_unbounded_of_range_of_timestamps_with_null]
SELECT RANGE_IS_END_UNBOUNDED(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, NULL)'),
       RANGE_IS_END_UNBOUNDED(RANGE<TIMESTAMP> '[NULL, 2019-01-01 12:00:00+08)'),
       RANGE_IS_END_UNBOUNDED(RANGE<TIMESTAMP> '[NULL, NULL)')
--
ARRAY<STRUCT<BOOL, BOOL, BOOL>>[{true, false, true}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_is_end_unbounded_of_range_of_casted_null]
SELECT RANGE_IS_END_UNBOUNDED(CAST(NULL AS RANGE<DATE>)),
       RANGE_IS_END_UNBOUNDED(CAST(NULL AS RANGE<DATETIME>)),
       RANGE_IS_END_UNBOUNDED(CAST(NULL AS RANGE<TIMESTAMP>));
--
ARRAY<STRUCT<BOOL, BOOL, BOOL>>[{NULL, NULL, NULL}]
==

[required_features=RANGE_TYPE,CIVIL_TIME,INLINE_LAMBDA_ARGUMENT]
[name=range_is_end_unbounded_with_array_transform_array_struct_and_lambda]
SELECT ARRAY_TRANSFORM([STRUCT (RANGE<DATE> '[2014-01-01, 2015-01-01)' AS r)], e -> RANGE_IS_END_UNBOUNDED(e.r)),
       ARRAY_TRANSFORM([STRUCT (RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)' AS r)], e -> RANGE_IS_END_UNBOUNDED(e.r)),
       ARRAY_TRANSFORM([STRUCT (RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)' AS r)], e -> RANGE_IS_END_UNBOUNDED(e.r));
--
ARRAY<STRUCT<ARRAY<>, ARRAY<>, ARRAY<>>>[
  {ARRAY<BOOL>[false], ARRAY<BOOL>[false], ARRAY<BOOL>[false]}
]
==

[name=range_start_of_range_of_dates]
SELECT RANGE_START(RANGE<DATE> '[2014-01-01, 2015-01-01)'),
       RANGE_START(RANGE<DATE> '[2014-01-01, UNBOUNDED)'),
       RANGE_START(RANGE<DATE> '[UNBOUNDED, 2015-01-01)'),
       RANGE_START(RANGE<DATE> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<DATE, DATE, DATE, DATE>>[{2014-01-01, 2014-01-01, NULL, NULL}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_start_of_range_of_datetimes]
SELECT RANGE_START(RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)'),
       RANGE_START(RANGE<DATETIME> '[2016-01-01 12:00:00, UNBOUNDED)'),
       RANGE_START(RANGE<DATETIME> '[UNBOUNDED, 2017-01-01 12:00:00)'),
       RANGE_START(RANGE<DATETIME> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<DATETIME, DATETIME, DATETIME, DATETIME>>[
  {2016-01-01 12:00:00, 2016-01-01 12:00:00, NULL, NULL}
]
==

[name=range_start_of_range_of_timestamps]
SELECT RANGE_START(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)'),
       RANGE_START(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, UNBOUNDED)'),
       RANGE_START(RANGE<TIMESTAMP> '[UNBOUNDED, 2019-01-01 12:00:00+08)'),
       RANGE_START(RANGE<TIMESTAMP> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<TIMESTAMP, TIMESTAMP, TIMESTAMP, TIMESTAMP>>[
  {
    2018-10-01 04:00:00+00,
    2018-10-01 04:00:00+00,
    NULL,
    NULL
  }
]
==

[name=range_start_of_range_of_dates_with_null]
SELECT RANGE_START(RANGE<DATE> '[2014-01-01, NULL)'),
       RANGE_START(RANGE<DATE> '[NULL, 2015-01-01)'),
       RANGE_START(RANGE<DATE> '[NULL, NULL)');
--
ARRAY<STRUCT<DATE, DATE, DATE>>[{2014-01-01, NULL, NULL}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_start_of_range_of_datetimes_with_null]
SELECT RANGE_START(RANGE<DATETIME> '[2016-01-01 12:00:00, NULL)'),
       RANGE_START(RANGE<DATETIME> '[NULL, 2017-01-01 12:00:00)'),
       RANGE_START(RANGE<DATETIME> '[NULL, NULL)');
--
ARRAY<STRUCT<DATETIME, DATETIME, DATETIME>>[{2016-01-01 12:00:00, NULL, NULL}]
==

[name=range_start_of_range_of_timestamps_with_null]
SELECT RANGE_START(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, NULL)'),
       RANGE_START(RANGE<TIMESTAMP> '[NULL, 2019-01-01 12:00:00+08)'),
       RANGE_START(RANGE<TIMESTAMP> '[NULL, NULL)')
--
ARRAY<STRUCT<TIMESTAMP, TIMESTAMP, TIMESTAMP>>[
  {
    2018-10-01 04:00:00+00,
    NULL,
    NULL
  }
]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_start_of_range_of_casted_null]
SELECT RANGE_START(CAST(NULL AS RANGE<DATE>)),
       RANGE_START(CAST(NULL AS RANGE<DATETIME>)),
       RANGE_START(CAST(NULL AS RANGE<TIMESTAMP>));
--
ARRAY<STRUCT<DATE, DATETIME, TIMESTAMP>>[{NULL, NULL, NULL}]
==

[required_features=RANGE_TYPE,CIVIL_TIME,INLINE_LAMBDA_ARGUMENT]
[name=range_start_with_array_transform_array_struct_and_lambda]
SELECT ARRAY_TRANSFORM([STRUCT (RANGE<DATE> '[2014-01-01, 2015-01-01)' AS r)], e -> RANGE_START(e.r)),
       ARRAY_TRANSFORM([STRUCT (RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)' AS r)], e -> RANGE_START(e.r)),
       ARRAY_TRANSFORM([STRUCT (RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)' AS r)], e -> RANGE_START(e.r));
--
ARRAY<STRUCT<ARRAY<>, ARRAY<>, ARRAY<>>>[
  {
    ARRAY<DATE>[2014-01-01],
    ARRAY<TIMESTAMP>[2018-10-01 04:00:00+00],
    ARRAY<DATETIME>[2016-01-01 12:00:00]
  }
]
==

[name=range_end_of_range_of_dates]
SELECT RANGE_END(RANGE<DATE> '[2014-01-01, 2015-01-01)'),
       RANGE_END(RANGE<DATE> '[2014-01-01, UNBOUNDED)'),
       RANGE_END(RANGE<DATE> '[UNBOUNDED, 2015-01-01)'),
       RANGE_END(RANGE<DATE> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<DATE, DATE, DATE, DATE>>[{2015-01-01, NULL, 2015-01-01, NULL}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_end_of_range_of_datetimes]
SELECT RANGE_END(RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)'),
       RANGE_END(RANGE<DATETIME> '[2016-01-01 12:00:00, UNBOUNDED)'),
       RANGE_END(RANGE<DATETIME> '[UNBOUNDED, 2017-01-01 12:00:00)'),
       RANGE_END(RANGE<DATETIME> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<DATETIME, DATETIME, DATETIME, DATETIME>>[
  {2017-01-01 12:00:00, NULL, 2017-01-01 12:00:00, NULL}
]
==

[name=range_end_of_range_of_timestamps]
SELECT RANGE_END(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)'),
       RANGE_END(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, UNBOUNDED)'),
       RANGE_END(RANGE<TIMESTAMP> '[UNBOUNDED, 2019-01-01 12:00:00+08)'),
       RANGE_END(RANGE<TIMESTAMP> '[UNBOUNDED, UNBOUNDED)');
--
ARRAY<STRUCT<TIMESTAMP, TIMESTAMP, TIMESTAMP, TIMESTAMP>>[
  {
    2019-01-01 04:00:00+00,
    NULL,
    2019-01-01 04:00:00+00,
    NULL
  }
]
==

[name=range_end_of_range_of_dates_with_null]
SELECT RANGE_END(RANGE<DATE> '[2014-01-01, NULL)'),
       RANGE_END(RANGE<DATE> '[NULL, 2015-01-01)'),
       RANGE_END(RANGE<DATE> '[NULL, NULL)');
--
ARRAY<STRUCT<DATE, DATE, DATE>>[{NULL, 2015-01-01, NULL}]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_end_of_range_of_datetimes_with_null]
SELECT RANGE_END(RANGE<DATETIME> '[2016-01-01 12:00:00, NULL)'),
       RANGE_END(RANGE<DATETIME> '[NULL, 2017-01-01 12:00:00)'),
       RANGE_END(RANGE<DATETIME> '[NULL, NULL)');
--
ARRAY<STRUCT<DATETIME, DATETIME, DATETIME>>[{NULL, 2017-01-01 12:00:00, NULL}]
==

[name=range_end_of_range_of_timestamps_with_null]
SELECT RANGE_END(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, NULL)'),
       RANGE_END(RANGE<TIMESTAMP> '[NULL, 2019-01-01 12:00:00+08)'),
       RANGE_END(RANGE<TIMESTAMP> '[NULL, NULL)')
--
ARRAY<STRUCT<TIMESTAMP, TIMESTAMP, TIMESTAMP>>[
  {
    NULL,
    2019-01-01 04:00:00+00,
    NULL
  }
]
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_end_of_range_of_casted_null]
SELECT RANGE_END(CAST(NULL AS RANGE<DATE>)),
       RANGE_END(CAST(NULL AS RANGE<DATETIME>)),
       RANGE_END(CAST(NULL AS RANGE<TIMESTAMP>));
--
ARRAY<STRUCT<DATE, DATETIME, TIMESTAMP>>[{NULL, NULL, NULL}]
==

[required_features=RANGE_TYPE,CIVIL_TIME,INLINE_LAMBDA_ARGUMENT]
[name=range_end_with_array_transform_array_struct_and_lambda]
SELECT ARRAY_TRANSFORM([STRUCT (RANGE<DATE> '[2014-01-01, 2015-01-01)' AS r)], e -> RANGE_END(e.r)),
       ARRAY_TRANSFORM([STRUCT (RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)' AS r)], e -> RANGE_END(e.r)),
       ARRAY_TRANSFORM([STRUCT (RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)' AS r)], e -> RANGE_END(e.r));
--
ARRAY<STRUCT<ARRAY<>, ARRAY<>, ARRAY<>>>[
  {
    ARRAY<DATE>[2015-01-01],
    ARRAY<TIMESTAMP>[2019-01-01 04:00:00+00],
    ARRAY<DATETIME>[2017-01-01 12:00:00]
  }
]
==

[name=range_intersect_throws_error_when_range_of_dates_do_not_overlap]
SELECT RANGE_INTERSECT(RANGE<DATE> '[2014-01-01, 2020-01-01)', RANGE<DATE> '[2021-01-01, 2022-01-01)');
--
ERROR: generic::out_of_range: Provided RANGE inputs: RANGE<DATE>[2014-01-01, 2020-01-01) and RANGE<DATE>[2021-01-01, 2022-01-01) do not overlap. Please check RANGE_OVERLAPS before calling RANGE_INTERSECT
==

[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_intersect_throws_error_when_range_of_datetimes_do_not_overlap]
SELECT RANGE_INTERSECT(RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)', RANGE<DATETIME> '[2018-01-01 12:00:00, 2019-01-01 12:00:00)');
--
ERROR: generic::out_of_range: Provided RANGE inputs: RANGE<DATETIME>[2016-01-01 12:00:00, 2017-01-01 12:00:00) and RANGE<DATETIME>[2018-01-01 12:00:00, 2019-01-01 12:00:00) do not overlap. Please check RANGE_OVERLAPS before calling RANGE_INTERSECT
==

[name=range_intersect_throws_error_when_range_of_timestamps_do_not_overlap]
SELECT RANGE_INTERSECT(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)', RANGE<TIMESTAMP> '[2020-10-01 12:00:00+08, 2021-01-01 12:00:00+08)');
--
ERROR: generic::out_of_range: Provided RANGE inputs: RANGE<TIMESTAMP>[
  2018-10-01 04:00:00+00,
  2019-01-01 04:00:00+00
) and RANGE<TIMESTAMP>[
  2020-10-01 04:00:00+00,
  2021-01-01 04:00:00+00
) do not overlap. Please check RANGE_OVERLAPS before calling RANGE_INTERSECT
==

[required_features=RANGE_TYPE,SAFE_FUNCTION_CALL]
[name=safe_range_intersect_throws_null_when_range_of_dates_do_not_overlap]
SELECT SAFE.RANGE_INTERSECT(RANGE<DATE> '[2014-01-01, 2020-01-01)', RANGE<DATE> '[2021-01-01, 2022-01-01)');
--
ARRAY<STRUCT<RANGE<DATE>>>[{NULL}]
==

[required_features=RANGE_TYPE,CIVIL_TIME,SAFE_FUNCTION_CALL]
[name=safe_range_intersect_throws_null_when_range_of_datetimes_do_not_overlap]
SELECT SAFE.RANGE_INTERSECT(RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)', RANGE<DATETIME> '[2018-01-01 12:00:00, 2019-01-01 12:00:00)');
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{NULL}]
==

[required_features=RANGE_TYPE,SAFE_FUNCTION_CALL]
[name=safe_range_intersect_throws_null_when_range_of_timestamps_do_not_overlap]
SELECT SAFE.RANGE_INTERSECT(RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)', RANGE<TIMESTAMP> '[2020-10-01 12:00:00+08, 2021-01-01 12:00:00+08)');
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[{NULL}]
==
[name=array_reverse_range_date_null]
[required_features=RANGE_TYPE]
SELECT ARRAY_REVERSE(CAST(NULL AS ARRAY<RANGE<DATE>>))
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<RANGE<DATE>>(NULL)}]
==
[name=array_reverse_range_datetime_null]
[required_features=RANGE_TYPE,CIVIL_TIME]
SELECT ARRAY_REVERSE(CAST(NULL AS ARRAY<RANGE<DATETIME>>))
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<RANGE<DATETIME>>(NULL)}]
==
[name=array_reverse_range_timestamp_null]
[required_features=RANGE_TYPE]
SELECT ARRAY_REVERSE(CAST(NULL AS ARRAY<RANGE<TIMESTAMP>>))
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<RANGE<TIMESTAMP>>(NULL)}]
==
[name=array_reverse_range_date_empty]
[required_features=RANGE_TYPE]
SELECT ARRAY_REVERSE(ARRAY<RANGE<DATE>>[])
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<RANGE<DATE>>[]}]
==
[name=array_reverse_range_datetime_empty]
[required_features=RANGE_TYPE,CIVIL_TIME]
SELECT ARRAY_REVERSE(ARRAY<RANGE<DATETIME>>[])
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<RANGE<DATETIME>>[]}]
==
[name=array_reverse_range_timestamp_empty]
[required_features=RANGE_TYPE]
SELECT ARRAY_REVERSE(ARRAY<RANGE<TIMESTAMP>>[])
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<RANGE<TIMESTAMP>>[]}]
==
[name=array_reverse_range_date]
[required_features=RANGE_TYPE]
SELECT ARRAY_REVERSE(ARRAY<RANGE<DATE>>[RANGE<DATE> "[2014-01-01, 2015-01-01)", RANGE<DATE> "[2014-01-01, UNBOUNDED)", RANGE<DATE> "[UNBOUNDED, 2015-01-01)", RANGE<DATE> "[UNBOUNDED, UNBOUNDED)"])
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<RANGE<DATE>>[known order:
     [NULL, NULL),
     [NULL, 2015-01-01),
     [2014-01-01, NULL),
     [2014-01-01, 2015-01-01)
   ]}
]
==
[name=array_reverse_range_datetime]
[required_features=RANGE_TYPE,CIVIL_TIME]
SELECT ARRAY_REVERSE(ARRAY<RANGE<DATETIME>>[RANGE<DATETIME> "[2014-01-01, 2015-01-01)", RANGE<DATETIME> "[2014-01-01, UNBOUNDED)", RANGE<DATETIME> "[UNBOUNDED, 2015-01-01)", RANGE<DATETIME> "[UNBOUNDED, UNBOUNDED)"])
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<RANGE<DATETIME>>[known order:
     [NULL, NULL),
     [NULL, 2015-01-01 00:00:00),
     [2014-01-01 00:00:00, NULL),
     [2014-01-01 00:00:00, 2015-01-01 00:00:00)
   ]}
]
==
[name=array_reverse_range_timestamp]
[required_features=RANGE_TYPE]
SELECT ARRAY_REVERSE(ARRAY<RANGE<TIMESTAMP>>[RANGE<TIMESTAMP> "[2014-01-01, 2015-01-01)", RANGE<TIMESTAMP> "[2014-01-01, UNBOUNDED)", RANGE<TIMESTAMP> "[UNBOUNDED, 2015-01-01)", RANGE<TIMESTAMP> "[UNBOUNDED, UNBOUNDED)"])
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<RANGE<TIMESTAMP>>[known order:
     [NULL, NULL),
     [
       NULL,
       2015-01-01 08:00:00+00
     ),
     [
       2014-01-01 08:00:00+00,
       NULL
     ),
     [
       2014-01-01 08:00:00+00,
       2015-01-01 08:00:00+00
     )
   ]}
]
