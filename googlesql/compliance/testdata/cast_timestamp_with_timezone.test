[default_time_zone=Etc/GMT+7]
==

# Test that if AT TIME ZONE is not specified, the default time zone is used.
[required_features=FORMAT_IN_CAST]
[name=cast_string_to_with_format_default_time_zone]
SELECT CAST('2134-05-06' as timestamp FORMAT 'yyyy-mm-dd')
--
ARRAY<STRUCT<TIMESTAMP>>[{2134-05-06 07:00:00+00}]
==
# Test that if AT TIME ZONE is specified, the user specified time zone is used.
[required_features=FORMAT_IN_CAST]
[name=cast_string_to_with_format_user_specified_time_zone]
SELECT CAST('2134-05-06' as timestamp FORMAT 'yyyy-mm-dd' AT TIME ZONE '-08')
--
ARRAY<STRUCT<TIMESTAMP>>[{2134-05-06 08:00:00+00}]
==

# Test that if AT TIME ZONE is not specified, the default time zone is used.
[required_features=FORMAT_IN_CAST]
[name=cast_string_to_with_format_default_time_zone_nanos]
SELECT CAST('2134-05-06' as timestamp FORMAT 'yyyy-mm-dd')
--
ARRAY<STRUCT<TIMESTAMP>>[{2134-05-06 07:00:00+00}]
==
# Test that if AT TIME ZONE is specified, the user specified time zone is used.
[required_features=FORMAT_IN_CAST]
[name=cast_string_to_with_format_user_specified_time_zone_nanos]
SELECT CAST('2134-05-06' as timestamp FORMAT 'yyyy-mm-dd' AT TIME ZONE '-08')
--
ARRAY<STRUCT<TIMESTAMP>>[{2134-05-06 08:00:00+00}]
