[name=cast_string_to_bytes_format_invalid_literal]
[default required_features=FORMAT_IN_CAST]
select cast('1' as bytes format 'abc');
--
ERROR: generic::out_of_range: Invalid format 'abc'
==
[name=safe_cast_string_to_bytes_format_invalid_literal]
select safe_cast('1' as bytes format 'abc');
--
ARRAY<STRUCT<BYTES>>[{NULL}]
==
[name=cast_string_to_timestamp_format_invalid_literal_with_timezone]
select cast('1' as timestamp format 'abc' at time zone 'UTC');
--
ERROR: generic::out_of_range: Cannot find matched format element at 0
==
[name=safe_cast_string_to_timestamp_format_invalid_literal_with_timezone]
select safe_cast('1' as timestamp format 'abc' at time zone 'UTC');
--
ARRAY<STRUCT<TIMESTAMP>>[{NULL}]
==
[name=cast_date_to_string_format_invalid_literal_hh]
select cast(date'1234-05-06' as string format 'HH');
--
ERROR: generic::out_of_range: DATE does not support 'HH'
==
[name=safe_cast_date_to_string_format_invalid_literal_hh]
select safe_cast(date'1234-05-06' as string format 'HH');
--
ARRAY<STRUCT<STRING>>[{NULL}]
==
[name=cast_datetime_to_string_format_invalid_literal_tzh]
[required_features=FORMAT_IN_CAST,CIVIL_TIME]
select cast(datetime '1234-05-06 07:08:09' as string format 'TZH');
--
ERROR: generic::out_of_range: DATETIME does not support 'TZH'
==
[name=safe_cast_datetime_to_string_format_invalid_literal_tzh]
[required_features=FORMAT_IN_CAST,CIVIL_TIME]
select safe_cast(datetime '1234-05-06 07:08:09' as string format 'TZH');
--
ARRAY<STRUCT<STRING>>[{NULL}]
==
[name=cast_time_to_string_format_invalid_literal_mm]
[required_features=FORMAT_IN_CAST,CIVIL_TIME]
select cast(time '07:08:09' as string format 'MM');
--
ERROR: generic::out_of_range: TIME does not support 'MM'
==
[name=safe_cast_time_to_string_format_invalid_literal_mm]
[required_features=FORMAT_IN_CAST,CIVIL_TIME]
select safe_cast(time '07:08:09' as string format 'MM');
--
ARRAY<STRUCT<STRING>>[{NULL}]
==
[name=cast_timestamp_to_string_format_invalid_literal]
select cast(timestamp '1234-05-06 07:08:09-10' as string format 'a');
--
ERROR: generic::out_of_range: Cannot find matched format element at 0
==
[name=safe_cast_timestamp_to_string_format_invalid_literal]
select safe_cast(timestamp '1234-05-06 07:08:09-10' as string format 'a');
--
ARRAY<STRUCT<STRING>>[{NULL}]
==
[name=cast_string_to_date_format_invalid_literal]
select cast('1234' as date format 'hh24');
--
ERROR: generic::out_of_range: Format element in category HOUR ('HH24') is not allowed for output type DATE
==
[name=safe_cast_string_to_date_format_invalid_literal]
select safe_cast('1234' as date format 'hh24');
--
ARRAY<STRUCT<DATE>>[{NULL}]
==
[name=cast_string_to_datetime_format_invalid_literal]
[required_features=FORMAT_IN_CAST,CIVIL_TIME]
select cast('1234' as datetime format 'tzh');
--
ERROR: generic::out_of_range: Format element in category TIME_ZONE ('TZH') is not allowed for output type DATETIME
==
[name=safe_cast_string_to_datetime_format_invalid_literal]
[required_features=FORMAT_IN_CAST,CIVIL_TIME]
select safe_cast('1234' as datetime format 'tzh');
--
ARRAY<STRUCT<DATETIME>>[{NULL}]
==
[name=cast_string_to_time_format_invalid_literal]
[required_features=FORMAT_IN_CAST,CIVIL_TIME]
select cast('1234' as time format 'yyyy');
--
ERROR: generic::out_of_range: Format element in category YEAR ('YYYY') is not allowed for output type TIME
==
[name=safe_cast_string_to_time_format_invalid_literal]
[required_features=FORMAT_IN_CAST,CIVIL_TIME]
select safe_cast('1234' as time format 'yyyy');
--
ARRAY<STRUCT<TIME>>[{NULL}]
==
[name=cast_string_to_timestamp_format_invalid_literal]
select cast('1234' as timestamp format 'a');
--
ERROR: generic::out_of_range: Cannot find matched format element at 0
==
[name=safe_cast_string_to_timestamp_format_invalid_literal]
select safe_cast('1234' as timestamp format 'a');
--
ARRAY<STRUCT<TIMESTAMP>>[{NULL}]
==
[name=cast_string_to_timestamp_format_invalid_timezone]
select cast('1234' as timestamp format 'yyyy' at time zone 'abc');
--
ERROR: generic::out_of_range: Invalid time zone: abc
==
[name=safe_cast_string_to_timestamp_format_invalid_timezone]
select safe_cast('1234' as timestamp format 'yyyy' at time zone 'abc');
--
ARRAY<STRUCT<TIMESTAMP>>[{NULL}]
==
[name=cast_invalid_numeric_format]
select cast(cast(1.23 as int32) as STRING format ',99');
--
ERROR: generic::out_of_range: Error in format string: Unexpected ','
==
[name=safe_cast_invalid_numeric_format]
select safe_cast(cast(1.23 as int32) as STRING format ',99');
--
ARRAY<STRUCT<STRING>>[{NULL}]
