# This file is driven by a test matrix with the following properties:
# The following 4 function signatures with lambda arguments are tested:
# ARRAY_OFFSET(array<T>, lambda(T) -> BOOL [ , ARRAY_FIND_MODE ] ) -> INT64
# ARRAY_OFFSETS(array<T>, lambda(T) -> BOOL) -> ARRAY<INT64>
# ARRAY_FIND(array<T>, lambda(T) -> BOOL [ , ARRAY_FIND_MODE ] ) -> T
# ARRAY_FIND_ALL(array<T>, lambda(T) -> BOOL) -> ARRAY<T>
# If ARRAY_OFFSET or ARRAY_FIND is selected, then the ARRAY_FIND_MODE enum is
# selected from ('FIRST', 'LAST', NULL, omitted).
# Array is chosen from (NULL, [], ['a', 'b', 'b', 'c', 'd']
# ['a', 'b', 'b', 'c', 'd', NULL], [NULL, NULL]).
# Lambda is chosen from (e -> NULL, e -> true, e -> false, e -> e = 'b').
# Additional lambdas for arrays containing null values: (e -> e IS/IS NOT NULL)
# Additional custom test cases are added per function signature/find mode
# combination for each of the following templated array types:
# FLOAT, DOUBLE, INT32, INT64, UINT32, UINT64, NUMERIC, BIGNUMERIC, BOOL, BYTES,
# STRING, collated STRING, DATE, TIMESTAMP, DATETIME, INTERVAL, STRUCT, ENUM.
[load_proto_files=googlesql/testdata/test_schema.proto]
[load_proto_names=googlesql_test.KitchenSinkPB, googlesql_test.TestOptionalFields]
[load_enum_names=googlesql_test.TestEnum]

==

[default required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS]
[name=array_offset_mode_first_input_null_array_lambda_null]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> NULL, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_null_array_lambda_true]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> true, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_null_array_lambda_false]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> false, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_null_array_lambda_some_true]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_null_array_lambda_null]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> NULL, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_null_array_lambda_true]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> true, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_null_array_lambda_false]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> false, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_null_array_lambda_some_true]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_null_array_lambda_null]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> NULL, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_null_array_lambda_true]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> true, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_null_array_lambda_false]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> false, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_null_array_lambda_some_true]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> e = 'b', NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_null_array_lambda_null]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_null_array_lambda_true]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> true)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_null_array_lambda_false]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> false)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_null_array_lambda_some_true]
SELECT ARRAY_OFFSET(CAST(NULL AS ARRAY<STRING>), e -> e = 'b')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offsets_input_null_array_lambda_null]
SELECT ARRAY_OFFSETS(CAST(NULL AS ARRAY<STRING>), e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>(NULL)}]
==

[name=array_offsets_input_null_array_lambda_true]
SELECT ARRAY_OFFSETS(CAST(NULL AS ARRAY<STRING>), e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>(NULL)}]
==

[name=array_offsets_input_null_array_lambda_false]
SELECT ARRAY_OFFSETS(CAST(NULL AS ARRAY<STRING>), e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>(NULL)}]
==

[name=array_offsets_input_null_array_lambda_some_true]
SELECT ARRAY_OFFSETS(CAST(NULL AS ARRAY<STRING>), e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>(NULL)}]
==

[name=array_find_mode_first_input_null_array_lambda_null]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> NULL, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_null_array_lambda_true]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> true, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_null_array_lambda_false]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> false, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_null_array_lambda_some_true]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_null_array_lambda_null]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> NULL, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_null_array_lambda_true]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> true, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_null_array_lambda_false]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> false, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_null_array_lambda_some_true]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_null_array_lambda_null]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> NULL, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_null_array_lambda_true]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> true, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_null_array_lambda_false]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> false, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_null_array_lambda_some_true]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> e = 'b', NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_null_array_lambda_null]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_null_array_lambda_true]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> true)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_null_array_lambda_false]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> false)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_null_array_lambda_some_true]
SELECT ARRAY_FIND(CAST(NULL AS ARRAY<STRING>), e -> e = 'b')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_all_input_null_array_lambda_null]
SELECT ARRAY_FIND_ALL(CAST(NULL AS ARRAY<STRING>), e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>(NULL)}]
==

[name=array_find_all_input_null_array_lambda_true]
SELECT ARRAY_FIND_ALL(CAST(NULL AS ARRAY<STRING>), e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>(NULL)}]
==

[name=array_find_all_input_null_array_lambda_false]
SELECT ARRAY_FIND_ALL(CAST(NULL AS ARRAY<STRING>), e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>(NULL)}]
==

[name=array_find_all_input_null_array_lambda_some_true]
SELECT ARRAY_FIND_ALL(CAST(NULL AS ARRAY<STRING>), e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>(NULL)}]
==

[name=array_offset_mode_first_input_empty_array_lambda_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> NULL, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_empty_array_lambda_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> true, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_empty_array_lambda_false]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> false, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_empty_array_lambda_some_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_empty_array_lambda_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> NULL, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_empty_array_lambda_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> true, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_empty_array_lambda_false]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> false, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_empty_array_lambda_some_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_empty_array_lambda_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> NULL, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_empty_array_lambda_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> true, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_empty_array_lambda_false]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> false, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_empty_array_lambda_some_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> e = 'b', NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_empty_array_lambda_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_empty_array_lambda_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> true)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_empty_array_lambda_false]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> false)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_empty_array_lambda_some_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[], e -> e = 'b')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offsets_input_empty_array_lambda_null]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[], e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_empty_array_lambda_true]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[], e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_empty_array_lambda_false]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[], e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_empty_array_lambda_some_true]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[], e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_find_mode_first_input_empty_array_lambda_null]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> NULL, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_empty_array_lambda_true]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> true, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_empty_array_lambda_false]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> false, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_empty_array_lambda_some_true]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_empty_array_lambda_null]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> NULL, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_empty_array_lambda_true]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> true, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_empty_array_lambda_false]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> false, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_empty_array_lambda_some_true]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_empty_array_lambda_null]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> NULL, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_empty_array_lambda_true]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> true, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_empty_array_lambda_false]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> false, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_empty_array_lambda_some_true]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> e = 'b', NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_empty_array_lambda_null]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_empty_array_lambda_true]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> true)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_empty_array_lambda_false]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> false)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_empty_array_lambda_some_true]
SELECT ARRAY_FIND(ARRAY<STRING>[], e -> e = 'b')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_all_input_empty_array_lambda_null]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[], e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_empty_array_lambda_true]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[], e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_empty_array_lambda_false]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[], e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_empty_array_lambda_some_true]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[], e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_offset_mode_first_input_string_array_lambda_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> NULL, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_string_array_lambda_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> true, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_first_input_string_array_lambda_false]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> false, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_string_array_lambda_some_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_string_array_lambda_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> NULL, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_string_array_lambda_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> true, 'LAST')
--
ARRAY<STRUCT<INT64>>[{4}]
==

[name=array_offset_mode_last_input_string_array_lambda_false]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> false, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_string_array_lambda_some_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_offset_mode_null_input_string_array_lambda_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> NULL, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_string_array_lambda_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> true, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_string_array_lambda_false]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> false, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_string_array_lambda_some_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> e = 'b', NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_string_array_lambda_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_string_array_lambda_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> true)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_empty_input_string_array_lambda_false]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> false)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_string_array_lambda_some_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd'], e -> e = 'b')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_string_array_lambda_null]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd'], e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_string_array_lambda_true]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd'], e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1, 2, 3, 4]}]
==

[name=array_offsets_input_string_array_lambda_false]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd'], e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_string_array_lambda_some_true]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd'], e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2]}]
==

[name=array_find_mode_first_input_string_array_lambda_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> NULL, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_string_array_lambda_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> true, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{"a"}]
==

[name=array_find_mode_first_input_string_array_lambda_false]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> false, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_string_array_lambda_some_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<STRING>>[{"b"}]
==

[name=array_find_mode_last_input_string_array_lambda_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> NULL, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_string_array_lambda_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> true, 'LAST')
--
ARRAY<STRUCT<STRING>>[{"d"}]
==

[name=array_find_mode_last_input_string_array_lambda_false]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> false, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_string_array_lambda_some_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<STRING>>[{"b"}]
==

[name=array_find_mode_null_input_string_array_lambda_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> NULL, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_string_array_lambda_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> true, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_string_array_lambda_false]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> false, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_string_array_lambda_some_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> e = 'b', NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_string_array_lambda_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_string_array_lambda_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> true)
--
ARRAY<STRUCT<STRING>>[{"a"}]
==

[name=array_find_mode_empty_input_string_array_lambda_false]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> false)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_string_array_lambda_some_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd'], e -> e = 'b')
--
ARRAY<STRUCT<STRING>>[{"b"}]
==

[name=array_find_all_input_string_array_lambda_null]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd'], e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_string_array_lambda_true]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd'], e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[known order:"a", "b", "b", "c", "d"]}]
==

[name=array_find_all_input_string_array_lambda_false]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd'], e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_string_array_lambda_some_true]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd'], e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[known order:"b", "b"]}]
==

[name=array_offset_mode_first_input_array_with_null_lambda_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_array_with_null_lambda_is_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NULL, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{5}]
==

[name=array_offset_mode_first_input_array_with_null_lambda_is_not_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NOT NULL, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_first_input_array_with_null_lambda_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> true, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_first_input_array_with_null_lambda_false]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> false, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_array_with_null_lambda_some_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_array_with_null_lambda_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_array_with_null_lambda_is_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NULL, 'LAST')
--
ARRAY<STRUCT<INT64>>[{5}]
==

[name=array_offset_mode_last_input_array_with_null_lambda_is_not_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NOT NULL, 'LAST')
--
ARRAY<STRUCT<INT64>>[{4}]
==

[name=array_offset_mode_last_input_array_with_null_lambda_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> true, 'LAST')
--
ARRAY<STRUCT<INT64>>[{5}]
==

[name=array_offset_mode_last_input_array_with_null_lambda_false]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> false, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_array_with_null_lambda_some_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_offset_mode_null_input_array_with_null_lambda_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_array_with_null_lambda_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> true, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_array_with_null_lambda_false]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> false, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_array_with_null_lambda_some_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b', NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_array_with_null_lambda_null]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_array_with_null_lambda_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> true)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_empty_input_array_with_null_lambda_false]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> false)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_array_with_null_lambda_some_true]
SELECT ARRAY_OFFSET(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_array_with_null_lambda_null]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_array_with_null_lambda_is_null]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[5]}]
==

[name=array_offsets_input_array_with_null_lambda_is_not_null]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NOT NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1, 2, 3, 4]}]
==

[name=array_offsets_input_array_with_null_lambda_true]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd', NULL], e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1, 2, 3, 4, 5]}]
==

[name=array_offsets_input_array_with_null_lambda_false]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd', NULL], e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_array_with_null_lambda_some_true]
SELECT ARRAY_OFFSETS(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2]}]
==

[name=array_find_mode_first_input_array_with_null_lambda_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_array_with_null_lambda_is_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NULL, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_array_with_null_lambda_is_not_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NOT NULL, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{"a"}]
==

[name=array_find_mode_first_input_array_with_null_lambda_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> true, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{"a"}]
==

[name=array_find_mode_first_input_array_with_null_lambda_false]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> false, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_array_with_null_lambda_some_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<STRING>>[{"b"}]
==

[name=array_find_mode_last_input_array_with_null_lambda_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_null_lambda_is_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NULL, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_null_lambda_is_not_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NOT NULL, 'LAST')
--
ARRAY<STRUCT<STRING>>[{"d"}]
==

[name=array_find_mode_last_input_array_with_null_lambda_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> true, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_null_lambda_false]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> false, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_null_lambda_some_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<STRING>>[{"b"}]
==

[name=array_find_mode_null_input_array_with_null_lambda_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_array_with_null_lambda_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> true, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_array_with_null_lambda_false]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> false, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_array_with_null_lambda_some_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b', NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_array_with_null_lambda_null]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_array_with_null_lambda_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> true)
--
ARRAY<STRUCT<STRING>>[{"a"}]
==

[name=array_find_mode_empty_input_array_with_null_lambda_false]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> false)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_array_with_null_lambda_some_true]
SELECT ARRAY_FIND(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b')
--
ARRAY<STRUCT<STRING>>[{"b"}]
==

[name=array_find_all_input_array_with_null_lambda_null]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd', NULL], e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_array_with_null_lambda_is_null]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[NULL]}]
==

[name=array_find_all_input_array_with_null_lambda_is_not_null]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd', NULL], e -> e IS NOT NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[known order:"a", "b", "b", "c", "d"]}]
==

[name=array_find_all_input_array_with_null_lambda_true]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd', NULL], e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<STRING>[known order:"a", "b", "b", "c", "d", NULL]}
]
==

[name=array_find_all_input_array_with_null_lambda_false]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd', NULL], e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_array_with_null_lambda_some_true]
SELECT ARRAY_FIND_ALL(['a', 'b', 'b', 'c', 'd', NULL], e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[known order:"b", "b"]}]
==

[name=array_offset_mode_first_input_array_with_only_null_lambda_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> NULL, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_array_with_only_null_lambda_is_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> e IS NULL, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_first_input_array_with_only_null_lambda_is_not_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> e IS NOT NULL, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_array_with_only_null_lambda_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> true, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_first_input_array_with_only_null_lambda_false]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> false, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_first_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_array_with_only_null_lambda_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> NULL, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_array_with_only_null_lambda_is_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> e IS NULL, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_array_with_only_null_lambda_is_not_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> e IS NOT NULL, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_array_with_only_null_lambda_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> true, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_array_with_only_null_lambda_false]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> false, 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_last_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_array_with_only_null_lambda_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> NULL, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_array_with_only_null_lambda_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> true, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_array_with_only_null_lambda_false]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> false, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_null_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> e = 'b', NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_array_with_only_null_lambda_null]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_array_with_only_null_lambda_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> true)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_empty_input_array_with_only_null_lambda_false]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> false)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_OFFSET(ARRAY<STRING>[NULL, NULL], e -> e = 'b')
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offsets_input_array_with_only_null_lambda_null]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[NULL, NULL], e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_array_with_only_null_lambda_is_null]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[NULL, NULL], e -> e IS NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_offsets_input_array_with_only_null_lambda_is_not_null]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[NULL, NULL], e -> e IS NOT NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_array_with_only_null_lambda_true]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[NULL, NULL], e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_offsets_input_array_with_only_null_lambda_false]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[NULL, NULL], e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_offsets_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[NULL, NULL], e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[]}]
==

[name=array_find_mode_first_input_array_with_only_null_lambda_null]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> NULL, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_array_with_only_null_lambda_is_null]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> e IS NULL, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_array_with_only_null_lambda_is_not_null]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> e IS NOT NULL, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_array_with_only_null_lambda_true]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> true, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_array_with_only_null_lambda_false]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> false, 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_first_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> e = 'b', 'FIRST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_only_null_lambda_null]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> NULL, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_only_null_lambda_is_null]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> e IS NULL, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_only_null_lambda_is_not_null]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> e IS NOT NULL, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_only_null_lambda_true]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> true, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_only_null_lambda_false]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> false, 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_last_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> e = 'b', 'LAST')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_array_with_only_null_lambda_null]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> NULL, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_array_with_only_null_lambda_true]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> true, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_array_with_only_null_lambda_false]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> false, NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_null_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> e = 'b', NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_array_with_only_null_lambda_null]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_array_with_only_null_lambda_true]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> true)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_array_with_only_null_lambda_false]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> false)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_FIND(ARRAY<STRING>[NULL, NULL], e -> e = 'b')
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_all_input_array_with_only_null_lambda_null]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[NULL, NULL], e -> NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_array_with_only_null_lambda_is_null]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[NULL, NULL], e -> e IS NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[known order:NULL, NULL]}]
==

[name=array_find_all_input_array_with_only_null_lambda_is_not_null]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[NULL, NULL], e -> e IS NOT NULL)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_array_with_only_null_lambda_true]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[NULL, NULL], e -> true)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[known order:NULL, NULL]}]
==

[name=array_find_all_input_array_with_only_null_lambda_false]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[NULL, NULL], e -> false)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_find_all_input_array_with_only_null_lambda_some_true]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[NULL, NULL], e -> e = 'b')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[]}]
==

[name=array_offset_mode_first_input_float_array]
SELECT ARRAY_OFFSET(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_float_array]
SELECT ARRAY_OFFSET(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_null_input_float_array]
SELECT ARRAY_OFFSET(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_float_array]
SELECT ARRAY_OFFSET(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_float_array]
SELECT ARRAY_OFFSETS(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_find_mode_first_input_float_array]
SELECT ARRAY_FIND(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0, 'FIRST')
--
ARRAY<STRUCT<FLOAT>>[{1.1}]
==

[name=array_find_mode_last_input_float_array]
SELECT ARRAY_FIND(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0, 'LAST')
--
ARRAY<STRUCT<FLOAT>>[{2.2}]
==

[name=array_find_mode_null_input_float_array]
SELECT ARRAY_FIND(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0, NULL)
--
ARRAY<STRUCT<FLOAT>>[{NULL}]
==

[name=array_find_mode_empty_input_float_array]
SELECT ARRAY_FIND(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0)
--
ARRAY<STRUCT<FLOAT>>[{1.1}]
==

[name=array_find_all_input_float_array]
SELECT ARRAY_FIND_ALL(ARRAY<FLOAT>[1.1, 2.2, 3.3], e -> e < 3.0)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<FLOAT>[known order:1.1, 2.2]}]
==

[name=array_offset_mode_first_input_double_array]
SELECT ARRAY_OFFSET(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_double_array]
SELECT ARRAY_OFFSET(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_null_input_double_array]
SELECT ARRAY_OFFSET(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_double_array]
SELECT ARRAY_OFFSET(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_double_array]
SELECT ARRAY_OFFSETS(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_find_mode_first_input_double_array]
SELECT ARRAY_FIND(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0, 'FIRST')
--
ARRAY<STRUCT<DOUBLE>>[{1.1}]
==

[name=array_find_mode_last_input_double_array]
SELECT ARRAY_FIND(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0, 'LAST')
--
ARRAY<STRUCT<DOUBLE>>[{2.2}]
==

[name=array_find_mode_null_input_double_array]
SELECT ARRAY_FIND(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0, NULL)
--
ARRAY<STRUCT<DOUBLE>>[{NULL}]
==

[name=array_find_mode_empty_input_double_array]
SELECT ARRAY_FIND(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0)
--
ARRAY<STRUCT<DOUBLE>>[{1.1}]
==

[name=array_find_all_input_double_array]
SELECT ARRAY_FIND_ALL(ARRAY<DOUBLE>[1.1, 2.2, 3.3], e -> e < 3.0)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<DOUBLE>[known order:1.1, 2.2]}]
==

[name=array_offset_mode_first_input_uint32_array]
SELECT ARRAY_OFFSET(ARRAY<UINT32>[1, 2, 3], e -> e < 3, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_uint32_array]
SELECT ARRAY_OFFSET(ARRAY<UINT32>[1, 2, 3], e -> e < 3, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_null_input_uint32_array]
SELECT ARRAY_OFFSET(ARRAY<UINT32>[1, 2, 3], e -> e < 3, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_uint32_array]
SELECT ARRAY_OFFSET(ARRAY<UINT32>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_uint32_array]
SELECT ARRAY_OFFSETS(ARRAY<UINT32>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_find_mode_first_input_uint32_array]
SELECT ARRAY_FIND(ARRAY<UINT32>[1, 2, 3], e -> e < 3, 'FIRST')
--
ARRAY<STRUCT<UINT32>>[{1}]
==

[name=array_find_mode_last_input_uint32_array]
SELECT ARRAY_FIND(ARRAY<UINT32>[1, 2, 3], e -> e < 3, 'LAST')
--
ARRAY<STRUCT<UINT32>>[{2}]
==

[name=array_find_mode_null_input_uint32_array]
SELECT ARRAY_FIND(ARRAY<UINT32>[1, 2, 3], e -> e < 3, NULL)
--
ARRAY<STRUCT<UINT32>>[{NULL}]
==

[name=array_find_mode_empty_input_uint32_array]
SELECT ARRAY_FIND(ARRAY<UINT32>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<UINT32>>[{1}]
==

[name=array_find_all_input_uint32_array]
SELECT ARRAY_FIND_ALL(ARRAY<UINT32>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<UINT32>[known order:1, 2]}]
==

[name=array_offset_mode_first_input_uint64_array]
SELECT ARRAY_OFFSET(ARRAY<UINT64>[1, 2, 3], e -> e < 3, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_uint64_array]
SELECT ARRAY_OFFSET(ARRAY<UINT64>[1, 2, 3], e -> e < 3, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_null_input_uint64_array]
SELECT ARRAY_OFFSET(ARRAY<UINT64>[1, 2, 3], e -> e < 3, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_uint64_array]
SELECT ARRAY_OFFSET(ARRAY<UINT64>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_uint64_array]
SELECT ARRAY_OFFSETS(ARRAY<UINT64>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_find_mode_first_input_uint64_array]
SELECT ARRAY_FIND(ARRAY<UINT64>[1, 2, 3], e -> e < 3, 'FIRST')
--
ARRAY<STRUCT<UINT64>>[{1}]
==

[name=array_find_mode_last_input_uint64_array]
SELECT ARRAY_FIND(ARRAY<UINT64>[1, 2, 3], e -> e < 3, 'LAST')
--
ARRAY<STRUCT<UINT64>>[{2}]
==

[name=array_find_mode_null_input_uint64_array]
SELECT ARRAY_FIND(ARRAY<UINT64>[1, 2, 3], e -> e < 3, NULL)
--
ARRAY<STRUCT<UINT64>>[{NULL}]
==

[name=array_find_mode_empty_input_uint64_array]
SELECT ARRAY_FIND(ARRAY<UINT64>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<UINT64>>[{1}]
==

[name=array_find_all_input_uint64_array]
SELECT ARRAY_FIND_ALL(ARRAY<UINT64>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<UINT64>[known order:1, 2]}]
==

[name=array_offset_mode_first_input_int32_array]
SELECT ARRAY_OFFSET(ARRAY<INT32>[1, 2, 3], e -> e < 3, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_int32_array]
SELECT ARRAY_OFFSET(ARRAY<INT32>[1, 2, 3], e -> e < 3, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_null_input_int32_array]
SELECT ARRAY_OFFSET(ARRAY<INT32>[1, 2, 3], e -> e < 3, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_int32_array]
SELECT ARRAY_OFFSET(ARRAY<INT32>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_int32_array]
SELECT ARRAY_OFFSETS(ARRAY<INT32>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_find_mode_first_input_int32_array]
SELECT ARRAY_FIND(ARRAY<INT32>[1, 2, 3], e -> e < 3, 'FIRST')
--
ARRAY<STRUCT<INT32>>[{1}]
==

[name=array_find_mode_last_input_int32_array]
SELECT ARRAY_FIND(ARRAY<INT32>[1, 2, 3], e -> e < 3, 'LAST')
--
ARRAY<STRUCT<INT32>>[{2}]
==

[name=array_find_mode_null_input_int32_array]
SELECT ARRAY_FIND(ARRAY<INT32>[1, 2, 3], e -> e < 3, NULL)
--
ARRAY<STRUCT<INT32>>[{NULL}]
==

[name=array_find_mode_empty_input_int32_array]
SELECT ARRAY_FIND(ARRAY<INT32>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<INT32>>[{1}]
==

[name=array_find_all_input_int32_array]
SELECT ARRAY_FIND_ALL(ARRAY<INT32>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT32>[known order:1, 2]}]
==

[name=array_offset_mode_first_input_int64_array]
SELECT ARRAY_OFFSET(ARRAY<INT64>[1, 2, 3], e -> e < 3, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_int64_array]
SELECT ARRAY_OFFSET(ARRAY<INT64>[1, 2, 3], e -> e < 3, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_null_input_int64_array]
SELECT ARRAY_OFFSET(ARRAY<INT64>[1, 2, 3], e -> e < 3, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_int64_array]
SELECT ARRAY_OFFSET(ARRAY<INT64>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_int64_array]
SELECT ARRAY_OFFSETS(ARRAY<INT64>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_find_mode_first_input_int64_array]
SELECT ARRAY_FIND(ARRAY<INT64>[1, 2, 3], e -> e < 3, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_find_mode_last_input_int64_array]
SELECT ARRAY_FIND(ARRAY<INT64>[1, 2, 3], e -> e < 3, 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_find_mode_null_input_int64_array]
SELECT ARRAY_FIND(ARRAY<INT64>[1, 2, 3], e -> e < 3, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_find_mode_empty_input_int64_array]
SELECT ARRAY_FIND(ARRAY<INT64>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_find_all_input_int64_array]
SELECT ARRAY_FIND_ALL(ARRAY<INT64>[1, 2, 3], e -> e < 3)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offset_mode_first_input_numeric_array]
SELECT ARRAY_OFFSET(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offset_mode_last_input_numeric_array]
SELECT ARRAY_OFFSET(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offset_mode_null_input_numeric_array]
SELECT ARRAY_OFFSET(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offset_mode_empty_input_numeric_array]
SELECT ARRAY_OFFSET(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offsets_input_numeric_array]
SELECT ARRAY_OFFSETS(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_mode_first_input_numeric_array]
SELECT ARRAY_FIND(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0, 'FIRST')
--
ARRAY<STRUCT<NUMERIC>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_mode_last_input_numeric_array]
SELECT ARRAY_FIND(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0, 'LAST')
--
ARRAY<STRUCT<NUMERIC>>[{1.000000001}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_mode_null_input_numeric_array]
SELECT ARRAY_FIND(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0, NULL)
--
ARRAY<STRUCT<NUMERIC>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_mode_empty_input_numeric_array]
SELECT ARRAY_FIND(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0)
--
ARRAY<STRUCT<NUMERIC>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_all_input_numeric_array]
SELECT ARRAY_FIND_ALL(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001], e -> e >= 0)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<NUMERIC>[known order:0, 1.000000001]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offset_mode_first_input_bignumeric_array]
SELECT ARRAY_OFFSET(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offset_mode_last_input_bignumeric_array]
SELECT ARRAY_OFFSET(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offset_mode_null_input_bignumeric_array]
SELECT ARRAY_OFFSET(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offset_mode_empty_input_bignumeric_array]
SELECT ARRAY_OFFSET(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offsets_input_bignumeric_array]
SELECT ARRAY_OFFSETS(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_mode_first_input_bignumeric_array]
SELECT ARRAY_FIND(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0, 'FIRST')
--
ARRAY<STRUCT<BIGNUMERIC>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_mode_last_input_bignumeric_array]
SELECT ARRAY_FIND(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0, 'LAST')
--
ARRAY<STRUCT<BIGNUMERIC>>[{1.00000000000000000000000000000000000001}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_mode_null_input_bignumeric_array]
SELECT ARRAY_FIND(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0, NULL)
--
ARRAY<STRUCT<BIGNUMERIC>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_mode_empty_input_bignumeric_array]
SELECT ARRAY_FIND(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0)
--
ARRAY<STRUCT<BIGNUMERIC>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_all_input_bignumeric_array]
SELECT ARRAY_FIND_ALL(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001], e -> e >= 0)
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<BIGNUMERIC>[known order:
     0,
     1.00000000000000000000000000000000000001
   ]}
]
==
[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,UUID_TYPE]
[name=array_offset_mode_first_input_uuid_array]
SELECT ARRAY_OFFSET(ARRAY<UUID>['00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001'], e -> e = '00000000-0000-0000-0000-000000000001', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==
[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,UUID_TYPE]
[name=array_offset_mode_last_input_uuid_array]
SELECT ARRAY_OFFSET(ARRAY<UUID>['00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001'], e -> e = '00000000-0000-0000-0000-000000000001', 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_first_input_float_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_float_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, 'LAST')
--
ARRAY<STRUCT<INT64>>[{3}]
==

[name=array_offset_mode_null_input_float_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_float_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4)
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_float_array_lambda_range]
SELECT ARRAY_OFFSETS(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2, 3]}]
==

[name=array_find_mode_first_input_float_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, 'FIRST')
--
ARRAY<STRUCT<FLOAT>>[{2.2}]
==

[name=array_find_mode_last_input_float_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, 'LAST')
--
ARRAY<STRUCT<FLOAT>>[{4.4}]
==

[name=array_find_mode_null_input_float_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, NULL)
--
ARRAY<STRUCT<FLOAT>>[{NULL}]
==

[name=array_find_mode_empty_input_float_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4)
--
ARRAY<STRUCT<FLOAT>>[{2.2}]
==

[name=array_find_all_input_float_array_lambda_range]
SELECT ARRAY_FIND_ALL(ARRAY<FLOAT>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<FLOAT>[known order:2.2, 3.3, 4.4]}]
==

[name=array_offset_mode_first_input_double_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_double_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, 'LAST')
--
ARRAY<STRUCT<INT64>>[{3}]
==

[name=array_offset_mode_null_input_double_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_double_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4)
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_double_array_lambda_range]
SELECT ARRAY_OFFSETS(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2, 3]}]
==

[name=array_find_mode_first_input_double_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, 'FIRST')
--
ARRAY<STRUCT<DOUBLE>>[{2.2}]
==

[name=array_find_mode_last_input_double_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, 'LAST')
--
ARRAY<STRUCT<DOUBLE>>[{4.4}]
==

[name=array_find_mode_null_input_double_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4, NULL)
--
ARRAY<STRUCT<DOUBLE>>[{NULL}]
==

[name=array_find_mode_empty_input_double_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4)
--
ARRAY<STRUCT<DOUBLE>>[{2.2}]
==

[name=array_find_all_input_double_array_lambda_range]
SELECT ARRAY_FIND_ALL(ARRAY<DOUBLE>[1.1, 2.2, 3.3, 4.4, 5.5], e -> e BETWEEN 2.2 AND 4.4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<DOUBLE>[known order:2.2, 3.3, 4.4]}]
==

[name=array_offset_mode_first_input_uint32_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_uint32_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'LAST')
--
ARRAY<STRUCT<INT64>>[{3}]
==

[name=array_offset_mode_null_input_uint32_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_uint32_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_uint32_array_lambda_range]
SELECT ARRAY_OFFSETS(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2, 3]}]
==

[name=array_find_mode_first_input_uint32_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'FIRST')
--
ARRAY<STRUCT<UINT32>>[{2}]
==

[name=array_find_mode_last_input_uint32_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'LAST')
--
ARRAY<STRUCT<UINT32>>[{4}]
==

[name=array_find_mode_null_input_uint32_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, NULL)
--
ARRAY<STRUCT<UINT32>>[{NULL}]
==

[name=array_find_mode_empty_input_uint32_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<UINT32>>[{2}]
==

[name=array_find_all_input_uint32_array_lambda_range]
SELECT ARRAY_FIND_ALL(ARRAY<UINT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<UINT32>[known order:2, 3, 4]}]
==

[name=array_offset_mode_first_input_uint64_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_uint64_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'LAST')
--
ARRAY<STRUCT<INT64>>[{3}]
==

[name=array_offset_mode_null_input_uint64_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_uint64_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_uint64_array_lambda_range]
SELECT ARRAY_OFFSETS(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2, 3]}]
==

[name=array_find_mode_first_input_uint64_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'FIRST')
--
ARRAY<STRUCT<UINT64>>[{2}]
==

[name=array_find_mode_last_input_uint64_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'LAST')
--
ARRAY<STRUCT<UINT64>>[{4}]
==

[name=array_find_mode_null_input_uint64_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, NULL)
--
ARRAY<STRUCT<UINT64>>[{NULL}]
==

[name=array_find_mode_empty_input_uint64_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<UINT64>>[{2}]
==

[name=array_find_all_input_uint64_array_lambda_range]
SELECT ARRAY_FIND_ALL(ARRAY<UINT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<UINT64>[known order:2, 3, 4]}]
==

[name=array_offset_mode_first_input_int32_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_int32_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'LAST')
--
ARRAY<STRUCT<INT64>>[{3}]
==

[name=array_offset_mode_null_input_int32_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_int32_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_int32_array_lambda_range]
SELECT ARRAY_OFFSETS(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2, 3]}]
==

[name=array_find_mode_first_input_int32_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'FIRST')
--
ARRAY<STRUCT<INT32>>[{2}]
==

[name=array_find_mode_last_input_int32_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'LAST')
--
ARRAY<STRUCT<INT32>>[{4}]
==

[name=array_find_mode_null_input_int32_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, NULL)
--
ARRAY<STRUCT<INT32>>[{NULL}]
==

[name=array_find_mode_empty_input_int32_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<INT32>>[{2}]
==

[name=array_find_all_input_int32_array_lambda_range]
SELECT ARRAY_FIND_ALL(ARRAY<INT32>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT32>[known order:2, 3, 4]}]
==

[name=array_offset_mode_first_input_int64_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_int64_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'LAST')
--
ARRAY<STRUCT<INT64>>[{3}]
==

[name=array_offset_mode_null_input_int64_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_int64_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_int64_array_lambda_range]
SELECT ARRAY_OFFSETS(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2, 3]}]
==

[name=array_find_mode_first_input_int64_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_find_mode_last_input_int64_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, 'LAST')
--
ARRAY<STRUCT<INT64>>[{4}]
==

[name=array_find_mode_null_input_int64_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_find_mode_empty_input_int64_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_find_all_input_int64_array_lambda_range]
SELECT ARRAY_FIND_ALL(ARRAY<INT64>[1, 2, 3, 4, 5], e -> e BETWEEN 2 AND 4)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:2, 3, 4]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offset_mode_first_input_numeric_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offset_mode_last_input_numeric_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2, 'LAST')
--
ARRAY<STRUCT<INT64>>[{3}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offset_mode_null_input_numeric_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offset_mode_empty_input_numeric_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_offsets_input_numeric_array_lambda_range]
SELECT ARRAY_OFFSETS(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1, 3]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_mode_first_input_numeric_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2, 'FIRST')
--
ARRAY<STRUCT<NUMERIC>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_mode_last_input_numeric_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2, 'LAST')
--
ARRAY<STRUCT<NUMERIC>>[{2}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_mode_null_input_numeric_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2, NULL)
--
ARRAY<STRUCT<NUMERIC>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_mode_empty_input_numeric_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2)
--
ARRAY<STRUCT<NUMERIC>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,NUMERIC_TYPE]
[name=array_find_all_input_numeric_array_lambda_range]
SELECT ARRAY_FIND_ALL(ARRAY<NUMERIC>[0, 1.000000001, -1.000000001, 2, 3], e -> e BETWEEN 0 AND 2)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<NUMERIC>[known order:0, 1.000000001, 2]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offset_mode_first_input_bignumeric_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offset_mode_last_input_bignumeric_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2, 'LAST')
--
ARRAY<STRUCT<INT64>>[{3}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offset_mode_null_input_bignumeric_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offset_mode_empty_input_bignumeric_array_lambda_range]
SELECT ARRAY_OFFSET(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_offsets_input_bignumeric_array_lambda_range]
SELECT ARRAY_OFFSETS(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1, 3]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_mode_first_input_bignumeric_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2, 'FIRST')
--
ARRAY<STRUCT<BIGNUMERIC>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_mode_last_input_bignumeric_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2, 'LAST')
--
ARRAY<STRUCT<BIGNUMERIC>>[{2}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_mode_null_input_bignumeric_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2, NULL)
--
ARRAY<STRUCT<BIGNUMERIC>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_mode_empty_input_bignumeric_array_lambda_range]
SELECT ARRAY_FIND(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2)
--
ARRAY<STRUCT<BIGNUMERIC>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,BIGNUMERIC_TYPE]
[name=array_find_all_input_bignumeric_array_lambda_range]
SELECT ARRAY_FIND_ALL(ARRAY<BIGNUMERIC>[0,1.00000000000000000000000000000000000001,-1.00000000000000000000000000000000000001, 2, 3], e -> e BETWEEN 0 AND 2)
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<BIGNUMERIC>[known order:
     0,
     1.00000000000000000000000000000000000001,
     2
   ]}
]
==

[name=array_offset_mode_first_input_bool_array]
SELECT ARRAY_OFFSET(ARRAY<BOOL>[true, false, true], e -> e, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_bool_array]
SELECT ARRAY_OFFSET(ARRAY<BOOL>[true, false, true], e -> e, 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_offset_mode_null_input_bool_array]
SELECT ARRAY_OFFSET(ARRAY<BOOL>[true, false, true], e -> e, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_bool_array]
SELECT ARRAY_OFFSET(ARRAY<BOOL>[true, false, true], e -> e)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_bool_array]
SELECT ARRAY_OFFSETS(ARRAY<BOOL>[true, false, true], e -> e)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 2]}]
==

[name=array_find_mode_first_input_bool_array]
SELECT ARRAY_FIND(ARRAY<BOOL>[true, false, true], e -> e, 'FIRST')
--
ARRAY<STRUCT<BOOL>>[{true}]
==

[name=array_find_mode_last_input_bool_array]
SELECT ARRAY_FIND(ARRAY<BOOL>[true, false, true], e -> e, 'LAST')
--
ARRAY<STRUCT<BOOL>>[{true}]
==

[name=array_find_mode_null_input_bool_array]
SELECT ARRAY_FIND(ARRAY<BOOL>[true, false, true], e -> e, NULL)
--
ARRAY<STRUCT<BOOL>>[{NULL}]
==

[name=array_find_mode_empty_input_bool_array]
SELECT ARRAY_FIND(ARRAY<BOOL>[true, false, true], e -> e)
--
ARRAY<STRUCT<BOOL>>[{true}]
==

[name=array_find_all_input_bool_array]
SELECT ARRAY_FIND_ALL(ARRAY<BOOL>[true, false, true], e -> e)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<BOOL>[known order:true, true]}]
==

[name=array_offset_mode_first_input_bytes_array]
SELECT ARRAY_OFFSET(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2", 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_bytes_array]
SELECT ARRAY_OFFSET(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2", 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_offset_mode_null_input_bytes_array]
SELECT ARRAY_OFFSET(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2", NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_bytes_array]
SELECT ARRAY_OFFSET(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2")
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_bytes_array]
SELECT ARRAY_OFFSETS(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2")
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2]}]
==

[name=array_find_mode_first_input_bytes_array]
SELECT ARRAY_FIND(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2", 'FIRST')
--
ARRAY<STRUCT<BYTES>>[{b"f2"}]
==

[name=array_find_mode_last_input_bytes_array]
SELECT ARRAY_FIND(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2", 'LAST')
--
ARRAY<STRUCT<BYTES>>[{b"f2"}]
==

[name=array_find_mode_null_input_bytes_array]
SELECT ARRAY_FIND(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2", NULL)
--
ARRAY<STRUCT<BYTES>>[{NULL}]
==

[name=array_find_mode_empty_input_bytes_array]
SELECT ARRAY_FIND(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2")
--
ARRAY<STRUCT<BYTES>>[{b"f2"}]
==

[name=array_find_all_input_bytes_array]
SELECT ARRAY_FIND_ALL(ARRAY<BYTES>[b"f1", b"f2", b"f2"], e -> e = b"f2")
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<BYTES>[known order:b"f2", b"f2"]}]
==

[name=array_offset_mode_first_input_string_array]
SELECT ARRAY_OFFSET(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_string_array]
SELECT ARRAY_OFFSET(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo', 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_offset_mode_null_input_string_array]
SELECT ARRAY_OFFSET(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo', NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_string_array]
SELECT ARRAY_OFFSET(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_string_array]
SELECT ARRAY_OFFSETS(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 2]}]
==

[name=array_find_mode_first_input_string_array]
SELECT ARRAY_FIND(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo', 'FIRST')
--
ARRAY<STRUCT<STRING>>[{"foo"}]
==

[name=array_find_mode_last_input_string_array]
SELECT ARRAY_FIND(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo', 'LAST')
--
ARRAY<STRUCT<STRING>>[{"foo"}]
==

[name=array_find_mode_null_input_string_array]
SELECT ARRAY_FIND(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo', NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[name=array_find_mode_empty_input_string_array]
SELECT ARRAY_FIND(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo')
--
ARRAY<STRUCT<STRING>>[{"foo"}]
==

[name=array_find_all_input_string_array]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>["foo","bar","foo"], e -> e = 'foo')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[known order:"foo", "foo"]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_offset_mode_first_input_string_array_with_collation_ci]
SELECT ARRAY_OFFSET(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'), 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_offset_mode_last_input_string_array_with_collation_ci]
SELECT ARRAY_OFFSET(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'), 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_offset_mode_null_input_string_array_with_collation_ci]
SELECT ARRAY_OFFSET(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'), NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_offset_mode_empty_input_string_array_with_collation_ci]
SELECT ARRAY_OFFSET(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'))
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_offsets_input_string_array_with_collation_ci]
SELECT ARRAY_OFFSETS(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'))
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1, 2]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_find_mode_first_input_string_array_with_collation_ci]
SELECT ARRAY_FIND(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'), 'FIRST')
--
ARRAY<STRUCT<STRING>>[{"ABC"}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_find_mode_last_input_string_array_with_collation_ci]
SELECT ARRAY_FIND(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'), 'LAST')
--
ARRAY<STRUCT<STRING>>[{"aBc"}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_find_mode_null_input_string_array_with_collation_ci]
SELECT ARRAY_FIND(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'), NULL)
--
ARRAY<STRUCT<STRING>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_find_mode_empty_input_string_array_with_collation_ci]
SELECT ARRAY_FIND(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'))
--
ARRAY<STRUCT<STRING>>[{"ABC"}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,ANNOTATION_FRAMEWORK,COLLATION_SUPPORT]
[name=array_find_all_input_string_array_with_collation_ci]
SELECT ARRAY_FIND_ALL(ARRAY<STRING>[COLLATE('ABC', 'und:ci'), COLLATE('abc', 'und:ci'), COLLATE('aBc', 'und:ci')], e -> e = COLLATE('abc', 'und:ci'))
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<STRING>[known order:"ABC", "abc", "aBc"]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_first_input_date_array]
SELECT ARRAY_OFFSET(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_last_input_date_array]
SELECT ARRAY_OFFSET(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00', 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_null_input_date_array]
SELECT ARRAY_OFFSET(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00', NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_empty_input_date_array]
SELECT ARRAY_OFFSET(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offsets_input_date_array]
SELECT ARRAY_OFFSETS(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_first_input_date_array]
SELECT ARRAY_FIND(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00', 'FIRST')
--
ARRAY<STRUCT<DATE>>[{2000-01-01}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_last_input_date_array]
SELECT ARRAY_FIND(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00', 'LAST')
--
ARRAY<STRUCT<DATE>>[{2015-12-30}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_null_input_date_array]
SELECT ARRAY_FIND(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00', NULL)
--
ARRAY<STRUCT<DATE>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_empty_input_date_array]
SELECT ARRAY_FIND(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00')
--
ARRAY<STRUCT<DATE>>[{2000-01-01}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_all_input_date_array]
SELECT ARRAY_FIND_ALL(ARRAY<DATE>[date '2000-01-01', date '2015-12-30', date '2022-12-30'], e -> e < datetime '2016-01-01 00:00:00')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<DATE>[known order:2000-01-01, 2015-12-30]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_first_input_time_array]
SELECT ARRAY_OFFSET(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_last_input_time_array]
SELECT ARRAY_OFFSET(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1, 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_null_input_time_array]
SELECT ARRAY_OFFSET(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_empty_input_time_array]
SELECT ARRAY_OFFSET(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1)
--
ARRAY<STRUCT<INT64>>[{1}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offsets_input_time_array]
SELECT ARRAY_OFFSETS(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_first_input_time_array]
SELECT ARRAY_FIND(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1, 'FIRST')
--
ARRAY<STRUCT<TIME>>[{01:00:00}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_last_input_time_array]
SELECT ARRAY_FIND(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1, 'LAST')
--
ARRAY<STRUCT<TIME>>[{01:00:01}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_null_input_time_array]
SELECT ARRAY_FIND(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1, NULL)
--
ARRAY<STRUCT<TIME>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_empty_input_time_array]
SELECT ARRAY_FIND(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1)
--
ARRAY<STRUCT<TIME>>[{01:00:00}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_all_input_time_array]
SELECT ARRAY_FIND_ALL(ARRAY<TIME>[time '12:01:59', time '1:00:00', time '1:00:01'], e -> EXTRACT(HOUR FROM e) = 1)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<TIME>[known order:01:00:00, 01:00:01]}]
==

[name=array_offset_mode_first_input_timestamp_array]
SELECT ARRAY_OFFSET([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_timestamp_array]
SELECT ARRAY_OFFSET([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013', 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_offset_mode_null_input_timestamp_array]
SELECT ARRAY_OFFSET([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013', NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_timestamp_array]
SELECT ARRAY_OFFSET([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_timestamp_array]
SELECT ARRAY_OFFSETS([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2]}]
==

[name=array_find_mode_first_input_timestamp_array]
SELECT ARRAY_FIND([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013', 'FIRST')
--
ARRAY<STRUCT<TIMESTAMP>>[{2013-02-01 20:34:56.789013+00}]
==

[name=array_find_mode_last_input_timestamp_array]
SELECT ARRAY_FIND([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013', 'LAST')
--
ARRAY<STRUCT<TIMESTAMP>>[{2024-09-11 08:01:01.001001+00}]
==

[name=array_find_mode_null_input_timestamp_array]
SELECT ARRAY_FIND([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013', NULL)
--
ARRAY<STRUCT<TIMESTAMP>>[{NULL}]
==

[name=array_find_mode_empty_input_timestamp_array]
SELECT ARRAY_FIND([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013')
--
ARRAY<STRUCT<TIMESTAMP>>[{2013-02-01 20:34:56.789013+00}]
==

[name=array_find_all_input_timestamp_array]
SELECT ARRAY_FIND_ALL([timestamp "2013-02-01 12:34:56.789012",timestamp "2013-02-01 12:34:56.789013", timestamp "2024-09-11 01:01:01.001001"], e -> e >= timestamp '2013-02-01 12:34:56.789013')
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<TIMESTAMP>[known order:
     2013-02-01 20:34:56.789013+00,
     2024-09-11 08:01:01.001001+00
   ]}
]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_first_input_datetime_array]
SELECT ARRAY_OFFSET(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00', 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_last_input_datetime_array]
SELECT ARRAY_OFFSET(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00', 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_null_input_datetime_array]
SELECT ARRAY_OFFSET(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00', NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offset_mode_empty_input_datetime_array]
SELECT ARRAY_OFFSET(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_offsets_input_datetime_array]
SELECT ARRAY_OFFSETS(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00')
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_first_input_datetime_array]
SELECT ARRAY_FIND(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00', 'FIRST')
--
ARRAY<STRUCT<DATETIME>>[{2011-01-01 00:00:00}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_last_input_datetime_array]
SELECT ARRAY_FIND(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00', 'LAST')
--
ARRAY<STRUCT<DATETIME>>[{2011-01-02 00:00:00}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_null_input_datetime_array]
SELECT ARRAY_FIND(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00', NULL)
--
ARRAY<STRUCT<DATETIME>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_mode_empty_input_datetime_array]
SELECT ARRAY_FIND(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00')
--
ARRAY<STRUCT<DATETIME>>[{2011-01-01 00:00:00}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,CIVIL_TIME]
[name=array_find_all_input_datetime_array]
SELECT ARRAY_FIND_ALL(ARRAY<DATETIME>[datetime '2011-01-01 00:00:00', datetime '2011-01-02 00:00:00', datetime '2021-01-03 00:00:00'], e -> e < datetime '2016-01-01 00:00:00')
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<DATETIME>[known order:2011-01-01 00:00:00, 2011-01-02 00:00:00]}
]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_offset_mode_first_input_interval_array]
SELECT ARRAY_OFFSET([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_offset_mode_last_input_interval_array]
SELECT ARRAY_OFFSET([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_offset_mode_null_input_interval_array]
SELECT ARRAY_OFFSET([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_offset_mode_empty_input_interval_array]
SELECT ARRAY_OFFSET([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_offsets_input_interval_array]
SELECT ARRAY_OFFSETS([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_find_mode_first_input_interval_array]
SELECT ARRAY_FIND([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day, 'FIRST')
--
ARRAY<STRUCT<INTERVAL>>[{0-0 1 0:0:0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_find_mode_last_input_interval_array]
SELECT ARRAY_FIND([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day, 'LAST')
--
ARRAY<STRUCT<INTERVAL>>[{0-0 0 24:0:0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_find_mode_null_input_interval_array]
SELECT ARRAY_FIND([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day, NULL)
--
ARRAY<STRUCT<INTERVAL>>[{NULL}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_find_mode_empty_input_interval_array]
SELECT ARRAY_FIND([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day)
--
ARRAY<STRUCT<INTERVAL>>[{0-0 1 0:0:0}]
==

[required_features=INLINE_LAMBDA_ARGUMENT,ARRAY_FIND_FUNCTIONS,INTERVAL_TYPE]
[name=array_find_all_input_interval_array]
SELECT ARRAY_FIND_ALL([interval 1 day, interval 24 hour, interval 1 hour], e -> e = interval 1 day)
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<INTERVAL>[known order:0-0 1 0:0:0, 0-0 0 24:0:0]}
]
==

[name=array_offset_mode_first_input_struct_array]
SELECT ARRAY_OFFSET([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_struct_array]
SELECT ARRAY_OFFSET([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_null_input_struct_array]
SELECT ARRAY_OFFSET([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_struct_array]
SELECT ARRAY_OFFSET([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_struct_array]
SELECT ARRAY_OFFSETS([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_find_mode_first_input_struct_array]
SELECT ARRAY_FIND([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3, 'FIRST')
--
ARRAY<STRUCT<STRUCT<a INT64, b INT64>>>[{{1, 2}}]
==

[name=array_find_mode_last_input_struct_array]
SELECT ARRAY_FIND([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3, 'LAST')
--
ARRAY<STRUCT<STRUCT<a INT64, b INT64>>>[{{3, 4}}]
==

[name=array_find_mode_null_input_struct_array]
SELECT ARRAY_FIND([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3, NULL)
--
ARRAY<STRUCT<STRUCT<a INT64, b INT64>>>[{NULL}]
==

[name=array_find_mode_empty_input_struct_array]
SELECT ARRAY_FIND([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3)
--
ARRAY<STRUCT<STRUCT<a INT64, b INT64>>>[{{1, 2}}]
==

[name=array_find_all_input_struct_array]
SELECT ARRAY_FIND_ALL([STRUCT(1 AS a, 2 AS b), STRUCT(3 AS a, 4 AS b), STRUCT(4 AS a, 5 AS b)], e -> e.a <= 3)
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<STRUCT<a INT64, b INT64>>[known order:{1, 2}, {3, 4}]}
]
==

[name=array_offset_mode_first_input_enum_array]
SELECT ARRAY_OFFSET(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_last_input_enum_array]
SELECT ARRAY_OFFSET(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0, 'LAST')
--
ARRAY<STRUCT<INT64>>[{2}]
==

[name=array_offset_mode_null_input_enum_array]
SELECT ARRAY_OFFSET(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_enum_array]
SELECT ARRAY_OFFSET(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0)
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offsets_input_enum_array]
SELECT ARRAY_OFFSETS(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:1, 2]}]
==

[name=array_find_mode_first_input_enum_array]
SELECT ARRAY_FIND(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0, 'FIRST')
--
ARRAY<STRUCT<ENUM<googlesql_test.TestEnum>>>[{TESTENUM1}]
==

[name=array_find_mode_last_input_enum_array]
SELECT ARRAY_FIND(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0, 'LAST')
--
ARRAY<STRUCT<ENUM<googlesql_test.TestEnum>>>[{TESTENUM1}]
==

[name=array_find_mode_null_input_enum_array]
SELECT ARRAY_FIND(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0, NULL)
--
ARRAY<STRUCT<ENUM<googlesql_test.TestEnum>>>[{NULL}]
==

[name=array_find_mode_empty_input_enum_array]
SELECT ARRAY_FIND(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0)
--
ARRAY<STRUCT<ENUM<googlesql_test.TestEnum>>>[{TESTENUM1}]
==

[name=array_find_all_input_enum_array]
SELECT ARRAY_FIND_ALL(ARRAY<googlesql_test.TestEnum>["TESTENUM0", "TESTENUM1", "TESTENUM1"], e -> e > 0)
--

ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<ENUM<googlesql_test.TestEnum>>[known order:TESTENUM1, TESTENUM1]}
]
==

[name=array_offset_mode_first_input_proto_array]
SELECT ARRAY_OFFSET([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30, 'FIRST')
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offset_mode_last_input_proto_array]
SELECT ARRAY_OFFSET([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30, 'LAST')
--
ARRAY<STRUCT<INT64>>[{1}]
==

[name=array_offset_mode_null_input_proto_array]
SELECT ARRAY_OFFSET([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30, NULL)
--
ARRAY<STRUCT<INT64>>[{NULL}]
==

[name=array_offset_mode_empty_input_proto_array]
SELECT ARRAY_OFFSET([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30)
--
ARRAY<STRUCT<INT64>>[{0}]
==

[name=array_offsets_input_proto_array]
SELECT ARRAY_OFFSETS([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30)
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<INT64>[known order:0, 1]}]
==

[name=array_find_mode_first_input_proto_array]
SELECT ARRAY_FIND([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30, 'FIRST')
--
ARRAY<STRUCT<PROTO<googlesql_test.KitchenSinkPB>>>[
  {{
     int64_key_1: 11
     int64_key_2: 12
   }}
]
==

[name=array_find_mode_last_input_proto_array]
SELECT ARRAY_FIND([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30, 'LAST')
--
ARRAY<STRUCT<PROTO<googlesql_test.KitchenSinkPB>>>[
  {{
     int64_key_1: 21
     int64_key_2: 22
   }}
]
==

[name=array_find_mode_null_input_proto_array]
SELECT ARRAY_FIND([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30, NULL)
--
ARRAY<STRUCT<PROTO<googlesql_test.KitchenSinkPB>>>[{NULL}]
==

[name=array_find_mode_empty_input_proto_array]
SELECT ARRAY_FIND([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30)
--
ARRAY<STRUCT<PROTO<googlesql_test.KitchenSinkPB>>>[
  {{
     int64_key_1: 11
     int64_key_2: 12
   }}
]
==

[name=array_find_all_input_proto_array]
SELECT ARRAY_FIND_ALL([NEW googlesql_test.KitchenSinkPB(11 AS int64_key_1, 12 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(21 AS int64_key_1, 22 AS int64_key_2),
  NEW googlesql_test.KitchenSinkPB(31 AS int64_key_1, 32 AS int64_key_2)], e -> e.int64_key_1 < 30)
--
ARRAY<STRUCT<ARRAY<>>>[
  {ARRAY<PROTO<googlesql_test.KitchenSinkPB>>[known order:
     {
       int64_key_1: 11
       int64_key_2: 12
     },
     {
       int64_key_1: 21
       int64_key_2: 22
     }
   ]}
]
