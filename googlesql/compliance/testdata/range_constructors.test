[default required_features=RANGE_TYPE]
[name=range_of_dates_literal_regular]
SELECT RANGE<DATE> '[2014-01-01, 2015-01-01)';
--
ARRAY<STRUCT<RANGE<DATE>>>[{[2014-01-01, 2015-01-01)}]
==
[name=range_of_dates_literal_unbounded_end]
SELECT RANGE<DATE> '[2014-01-01, UNBOUNDED)';
--
ARRAY<STRUCT<RANGE<DATE>>>[{[2014-01-01, NULL)}]
==
[name=range_of_dates_literal_unbounded_start]
SELECT RANGE<DATE> '[UNBOUNDED, 2015-01-01)';
--
ARRAY<STRUCT<RANGE<DATE>>>[{[NULL, 2015-01-01)}]
==
[name=range_of_dates_literal_unbounded_start_and_end]
SELECT RANGE<DATE> '[UNBOUNDED, UNBOUNDED)';
--
ARRAY<STRUCT<RANGE<DATE>>>[{[NULL, NULL)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_literal_regular]
SELECT RANGE<DATETIME> '[2016-01-01 12:00:00, 2017-01-01 12:00:00)';
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[2016-01-01 12:00:00, 2017-01-01 12:00:00)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_literal_unbounded_end]
SELECT RANGE<DATETIME> '[2016-01-01 12:00:00, UNBOUNDED)';
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[2016-01-01 12:00:00, NULL)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_literal_unbounded_start]
SELECT RANGE<DATETIME> '[UNBOUNDED, 2017-01-01 12:00:00)';
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[NULL, 2017-01-01 12:00:00)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_literal_unbounded_start_and_end]
SELECT RANGE<DATETIME> '[UNBOUNDED, UNBOUNDED)';
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[NULL, NULL)}]
==
[name=range_of_timestamps_literal_regular]
SELECT RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, 2019-01-01 12:00:00+08)';
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[
  {[
     2018-10-01 04:00:00+00,
     2019-01-01 04:00:00+00
   )}
]
==
[name=range_of_timestamps_literal_unbounded_end]
SELECT RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, UNBOUNDED)';
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[
  {[
     2018-10-01 04:00:00+00,
     NULL
   )}
]
==
[name=range_of_timestamps_literal_unbounded_start]
SELECT RANGE<TIMESTAMP> '[UNBOUNDED, 2019-01-01 12:00:00+08)';
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[
  {[
     NULL,
     2019-01-01 04:00:00+00
   )}
]
==
[name=range_of_timestamps_literal_unbounded_start_and_end]
SELECT RANGE<TIMESTAMP> '[UNBOUNDED, UNBOUNDED)';
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[{[NULL, NULL)}]
==
[name=range_of_dates_literal_null_end]
SELECT RANGE<DATE> '[2014-01-01, NULL)';
--
ARRAY<STRUCT<RANGE<DATE>>>[{[2014-01-01, NULL)}]
==
[name=range_of_dates_literal_null_start]
SELECT RANGE<DATE> '[NULL, 2015-01-01)';
--
ARRAY<STRUCT<RANGE<DATE>>>[{[NULL, 2015-01-01)}]
==
[name=range_of_dates_literal_null_start_and_end]
SELECT RANGE<DATE> '[NULL, NULL)';
--
ARRAY<STRUCT<RANGE<DATE>>>[{[NULL, NULL)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_literal_null_end]
SELECT RANGE<DATETIME> '[2016-01-01 12:00:00, NULL)';
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[2016-01-01 12:00:00, NULL)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_literal_null_start]
SELECT RANGE<DATETIME> '[NULL, 2017-01-01 12:00:00)';
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[NULL, 2017-01-01 12:00:00)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_literal_null_start_and_end]
SELECT RANGE<DATETIME> '[NULL, NULL)';
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[NULL, NULL)}]
==
[name=range_of_timestamps_literal_null_end]
SELECT RANGE<TIMESTAMP> '[2018-10-01 12:00:00+08, NULL)';
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[
  {[
     2018-10-01 04:00:00+00,
     NULL
   )}
]
==
[name=range_of_timestamps_literal_null_start]
SELECT RANGE<TIMESTAMP> '[NULL, 2019-01-01 12:00:00+08)';
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[
  {[
     NULL,
     2019-01-01 04:00:00+00
   )}
]
==
[name=range_of_dates_constructor_function_regular]
SELECT RANGE(DATE '2014-01-01', DATE '2015-01-01');
--
ARRAY<STRUCT<RANGE<DATE>>>[{[2014-01-01, 2015-01-01)}]
==
[name=range_of_dates_constructor_function_null_end]
SELECT RANGE(DATE '2014-01-01', NULL);
--
ARRAY<STRUCT<RANGE<DATE>>>[{[2014-01-01, NULL)}]
==
[name=range_of_dates_constructor_function_null_start]
SELECT RANGE(NULL, DATE '2015-01-01');
--
ARRAY<STRUCT<RANGE<DATE>>>[{[NULL, 2015-01-01)}]
==
[name=range_of_dates_constructor_function_null_start_and_end]
SELECT RANGE(CAST(NULL AS DATE), NULL);
--
ARRAY<STRUCT<RANGE<DATE>>>[{[NULL, NULL)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_constructor_function_regular]
SELECT RANGE(DATETIME '2016-01-01 12:00:00', DATETIME '2017-01-01 12:00:00'),
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[2016-01-01 12:00:00, 2017-01-01 12:00:00)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_constructor_function_unbounded_end]
SELECT RANGE(DATETIME '2016-01-01 12:00:00', NULL),
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[2016-01-01 12:00:00, NULL)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_constructor_function_unbounded_start]
SELECT RANGE(NULL, DATETIME '2017-01-01 12:00:00'),
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[NULL, 2017-01-01 12:00:00)}]
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_constructor_function_unbounded_start_and_end]
SELECT RANGE(CAST(NULL AS DATETIME), NULL),
--
ARRAY<STRUCT<RANGE<DATETIME>>>[{[NULL, NULL)}]
==
[name=range_of_timestamps_constructor_function_regular]
SELECT RANGE(TIMESTAMP '2018-10-01 12:00:00+08', TIMESTAMP '2019-01-01 12:00:00+08');
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[
  {[
     2018-10-01 04:00:00+00,
     2019-01-01 04:00:00+00
   )}
]
==
[name=range_of_timestamps_constructor_function_unbounded_end]
SELECT RANGE(TIMESTAMP '2018-10-01 12:00:00+08', NULL);
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[
  {[
     2018-10-01 04:00:00+00,
     NULL
   )}
]
==
[name=range_of_timestamps_constructor_function_unbounded_start]
SELECT RANGE(NULL, TIMESTAMP '2019-01-01 12:00:00+08');
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[
  {[
     NULL,
     2019-01-01 04:00:00+00
   )}
]
==
[name=range_of_timestamps_constructor_function_unbounded_start_and_end]
SELECT RANGE(CAST(NULL AS TIMESTAMP), NULL);
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[{[NULL, NULL)}]
==
[name=range_of_timestamps_constructor_function_with_expression]
SELECT RANGE(PARSE_TIMESTAMP("%Y-%m-%d", "2001-02-03", "UTC"), PARSE_TIMESTAMP("%Y-%m-%d", "2002-03-04", "UTC"))
--
ARRAY<STRUCT<RANGE<TIMESTAMP>>>[
  {[
     2001-02-03 00:00:00+00,
     2002-03-04 00:00:00+00
   )}
]
==
[name=range_of_dates_constructor_function_end_less_than_start]
SELECT RANGE(DATE '2014-01-01', DATE '2013-01-01');
--
ERROR: generic::invalid_argument: Range start element must be smaller than range end element
==
[name=range_of_timestamps_constructor_function_end_less_than_start]
SELECT RANGE(TIMESTAMP '2014-01-01', TIMESTAMP '2013-01-01');
--
ERROR: generic::invalid_argument: Range start element must be smaller than range end element
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_constructor_function_end_less_than_start]
SELECT RANGE(DATETIME '2014-01-01', DATETIME '2013-01-01');
--
ERROR: generic::invalid_argument: Range start element must be smaller than range end element
==
[name=range_of_dates_constructor_function_start_equals_end]
SELECT RANGE(DATE '2014-01-01', DATE '2014-01-01');
--
ERROR: generic::invalid_argument: Range start element must be smaller than range end element
==
[name=range_of_timestamps_constructor_function_start_equals_end]
SELECT RANGE(TIMESTAMP '2014-01-01', TIMESTAMP '2014-01-01');
--
ERROR: generic::invalid_argument: Range start element must be smaller than range end element
==
[required_features=RANGE_TYPE,CIVIL_TIME]
[name=range_of_datetimes_constructor_function_start_equals_end]
SELECT RANGE(DATETIME '2014-01-01', DATETIME '2014-01-01');
--
ERROR: generic::invalid_argument: Range start element must be smaller than range end element
==
[name=safe_range_constructor]
[required_features=RANGE_TYPE,SAFE_FUNCTION_CALL]
SELECT SAFE.RANGE(DATE '2020-01-01', DATE '2020-01-01'),
       SAFE.RANGE(DATE '2030-01-01', DATE '2020-01-01'),
       SAFE.RANGE(TIMESTAMP '2020-01-01', TIMESTAMP '2020-01-01'),
       SAFE.RANGE(TIMESTAMP '2030-01-01', TIMESTAMP '2020-01-01')
--
ARRAY<STRUCT<RANGE<DATE>, RANGE<DATE>, RANGE<TIMESTAMP>, RANGE<TIMESTAMP>>>[
  {NULL, NULL, NULL, NULL}
]
==
[name=safe_range_datetime_constructor]
[required_features=RANGE_TYPE,SAFE_FUNCTION_CALL,CIVIL_TIME]
SELECT SAFE.RANGE(DATETIME '2020-01-01', DATETIME '2020-01-01'),
       SAFE.RANGE(DATETIME '2030-01-01', DATETIME '2020-01-01')
--
ARRAY<STRUCT<RANGE<DATETIME>, RANGE<DATETIME>>>[{NULL, NULL}]
==

[required_features=RANGE_TYPE,TIMESTAMP_PICOS]
[name=range_literal_with_picoseconds]
SELECT
  RANGE(NULL, TIMESTAMP '2020-12-31 12:00:00.123456789123+08'),
  RANGE(TIMESTAMP '2020-10-01 12:00:00.123456789123+08', NULL),
  RANGE(TIMESTAMP '2020-10-01 12:00:00.123456789123+08', TIMESTAMP '2020-12-31 12:00:00.123456789123+08')
--
ARRAY<STRUCT<RANGE<TIMESTAMP>, RANGE<TIMESTAMP>, RANGE<TIMESTAMP>>>[
  {[
     NULL,
     2020-12-31 04:00:00.123456789123+00
   ),
   [
     2020-10-01 04:00:00.123456789123+00,
     NULL
   ),
   [
     2020-10-01 04:00:00.123456789123+00,
     2020-12-31 04:00:00.123456789123+00
   )}
]
